<?xml version="1.0" encoding="UTF-8"?>
<robot generator="Robot 5.0 (Python 3.9.0 on win32)" generated="20220722 15:42:42.721" rpa="false" schemaversion="3">
<suite id="s1" name="HealthCheckReadiness" source="C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestScript\HealthCheckReadiness.robot">
<test id="s1-t1" name="HealthCheck Readiness Success" line="5">
<kw name="Run Keywords" library="BuiltIn" type="SETUP">
<arg>Set Test Variable</arg>
<arg>${EXCEL_NAME}</arg>
<arg>${EXCEL_2C2P_PAYMENT}</arg>
<arg>AND</arg>
<arg>Set Test Variable</arg>
<arg>${SHEET_NAME}</arg>
<arg>${SHEET_HealthCheckReadiness}</arg>
<doc>Executes all the given keywords in a sequence.</doc>
<kw name="Set Test Variable" library="BuiltIn">
<arg>${EXCEL_NAME}</arg>
<arg>${EXCEL_2C2P_PAYMENT}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<msg timestamp="20220722 15:42:43.177" level="INFO">${EXCEL_NAME} = ./TestResource/DataTest/Excel_Script/PDPA_Script.xlsx</msg>
<status status="PASS" starttime="20220722 15:42:43.177" endtime="20220722 15:42:43.177"/>
</kw>
<kw name="Set Test Variable" library="BuiltIn">
<arg>${SHEET_NAME}</arg>
<arg>${SHEET_HealthCheckReadiness}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<msg timestamp="20220722 15:42:43.178" level="INFO">${SHEET_NAME} = HealthCheckReadiness</msg>
<status status="PASS" starttime="20220722 15:42:43.177" endtime="20220722 15:42:43.178"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.176" endtime="20220722 15:42:43.178"/>
</kw>
<kw name="API_HealthCheck_Readiness" library="API_HealthCheck">
<arg>2</arg>
<arg>200</arg>
<arg>HR1001_001</arg>
<kw name="Generate_File_Path_Request" library="PDPA_Keyword">
<arg>${JSON_CollectionPoint}</arg>
<doc>- สร้าง path สำหรับไฟล์ request เพื่อให้ใช้ได้ทุกๆเครื่อง</doc>
<kw name="Remove String" library="String">
<var>${NEWDIR}</var>
<arg>C:\\Users\\niranl\\OneDrive - The viriyah Insurance\\Desktop\\PDPA\\TestResource\\Keywords\\API_Keyword</arg>
<arg>${/}Keywords${/}API_Keyword</arg>
<doc>Removes all ``removables`` from the given ``string``.</doc>
<msg timestamp="20220722 15:42:43.180" level="INFO">${NEWDIR} = C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource</msg>
<status status="PASS" starttime="20220722 15:42:43.179" endtime="20220722 15:42:43.180"/>
</kw>
<kw name="Catenate" library="BuiltIn">
<var>${file_path_request}</var>
<arg>SEPARATOR=${/}</arg>
<arg>${NEWDIR}${/}DataTest${/}${path_request}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<msg timestamp="20220722 15:42:43.180" level="INFO">${file_path_request} = C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource\DataTest\./API_CollectionPoint/CollectionPointList</msg>
<status status="PASS" starttime="20220722 15:42:43.180" endtime="20220722 15:42:43.180"/>
</kw>
<kw name="Set Suite Variable" library="BuiltIn">
<arg>${path_request}</arg>
<doc>Makes a variable available everywhere within the scope of the current suite.</doc>
<msg timestamp="20220722 15:42:43.180" level="INFO">${path_request} = ./API_CollectionPoint/CollectionPointList</msg>
<status status="PASS" starttime="20220722 15:42:43.180" endtime="20220722 15:42:43.180"/>
</kw>
<kw name="Set Suite Variable" library="BuiltIn">
<arg>${file_path_request}</arg>
<doc>Makes a variable available everywhere within the scope of the current suite.</doc>
<msg timestamp="20220722 15:42:43.180" level="INFO">${file_path_request} = C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource\DataTest\./API_CollectionPoint/CollectionPointList</msg>
<status status="PASS" starttime="20220722 15:42:43.180" endtime="20220722 15:42:43.180"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.179" endtime="20220722 15:42:43.180"/>
</kw>
<kw name="Read_Excel_For_Test" library="ExcelKeyword">
<var>${data_test}</var>
<arg>${EXCEL_NAME}</arg>
<arg>${SHEET_NAME}</arg>
<arg>${rowNo}</arg>
<kw name="Open Excel Document" library="ExcelLibraryV2">
<arg>${fileExcel}</arg>
<arg>Test</arg>
<arg>True</arg>
<doc>Opens xlsx document file.</doc>
<status status="PASS" starttime="20220722 15:42:43.182" endtime="20220722 15:42:43.227"/>
</kw>
<kw name="Get List Sheet Names" library="ExcelLibraryV2">
<var>${sheets}</var>
<doc>Returns a list of sheet names in the current document.</doc>
<msg timestamp="20220722 15:42:43.228" level="INFO">${sheets} = ['CollectionPointList', 'CollectionPointInfo', 'GeneralConsentList', 'GeneralConsentSubmit', 'HealthCheckLiveness', 'HealthCheckReadiness']</msg>
<status status="PASS" starttime="20220722 15:42:43.228" endtime="20220722 15:42:43.228"/>
</kw>
<kw name="List Should Contain Value" library="Collections">
<arg>${sheets}</arg>
<arg>${sheetName}</arg>
<doc>Fails if the ``value`` is not found from ``list``.</doc>
<status status="PASS" starttime="20220722 15:42:43.228" endtime="20220722 15:42:43.228"/>
</kw>
<kw name="Read Excel Row" library="ExcelLibraryV2">
<var>@{HEAD}</var>
<arg>row_num=1</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Returns content of a row from the current sheet of the document.</doc>
<msg timestamp="20220722 15:42:43.229" level="INFO">@{HEAD} = [  TestResult | ExpectedApi | ExpectedRespone | actualRespone | TestCaseNumber | Test Description ]</msg>
<status status="PASS" starttime="20220722 15:42:43.228" endtime="20220722 15:42:43.229"/>
</kw>
<kw name="Read Excel Row" library="ExcelLibraryV2">
<var>@{DATA}</var>
<arg>row_num=${rowNo}</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Returns content of a row from the current sheet of the document.</doc>
<msg timestamp="20220722 15:42:43.229" level="INFO">@{DATA} = [ PASSED | 200 | None | {"Services":[{"Status":"Up","ServiceName":"DatabaseSql","Message":""}],"Status":"Up"} | HL1001_000 | Validate การทำงานของ Services   กรณี Services ทำงานได้ปกติ ]</msg>
<status status="PASS" starttime="20220722 15:42:43.229" endtime="20220722 15:42:43.229"/>
</kw>
<kw name="Log List" library="Collections">
<arg>${HEAD}</arg>
<doc>Logs the length and contents of the ``list`` using given ``level``.</doc>
<msg timestamp="20220722 15:42:43.230" level="INFO">List length is 6 and it contains following items:
0:  TestResult
1: ExpectedApi
2: ExpectedRespone
3: actualRespone
4: TestCaseNumber
5: Test Description</msg>
<status status="PASS" starttime="20220722 15:42:43.230" endtime="20220722 15:42:43.230"/>
</kw>
<kw name="Log List" library="Collections">
<arg>${DATA}</arg>
<doc>Logs the length and contents of the ``list`` using given ``level``.</doc>
<msg timestamp="20220722 15:42:43.230" level="INFO">List length is 6 and it contains following items:
0: PASSED
1: 200
2: None
3: {"Services":[{"Status":"Up","ServiceName":"DatabaseSql","Message":""}],"Status":"Up"}
4: HL1001_000
5: Validate การทำงานของ Services   กรณี Services ทำงานได้ปกติ</msg>
<status status="PASS" starttime="20220722 15:42:43.230" endtime="20220722 15:42:43.230"/>
</kw>
<kw name="Close All Excel Documents" library="ExcelLibraryV2">
<doc>Closes all opened documents.</doc>
<status status="PASS" starttime="20220722 15:42:43.230" endtime="20220722 15:42:43.230"/>
</kw>
<kw name="Create Dictionary" library="BuiltIn">
<var>${Test_Data}</var>
<doc>Creates and returns a dictionary based on the given ``items``.</doc>
<msg timestamp="20220722 15:42:43.231" level="INFO">${Test_Data} = {}</msg>
<status status="PASS" starttime="20220722 15:42:43.230" endtime="20220722 15:42:43.231"/>
</kw>
<kw name="Get Length" library="BuiltIn">
<var>${length}</var>
<arg>${DATA}</arg>
<doc>Returns and logs the length of the given item as an integer.</doc>
<msg timestamp="20220722 15:42:43.231" level="INFO">Length is 6</msg>
<msg timestamp="20220722 15:42:43.231" level="INFO">${length} = 6</msg>
<status status="PASS" starttime="20220722 15:42:43.231" endtime="20220722 15:42:43.231"/>
</kw>
<for flavor="IN RANGE">
<var>${i}</var>
<value>0</value>
<value>${length}</value>
<iter>
<var name="${i}">0</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:43.232" endtime="20220722 15:42:43.233"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.231" endtime="20220722 15:42:43.233"/>
</iter>
<iter>
<var name="${i}">1</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:43.234" endtime="20220722 15:42:43.236"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.234" endtime="20220722 15:42:43.236"/>
</iter>
<iter>
<var name="${i}">2</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:43.237" endtime="20220722 15:42:43.239"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.236" endtime="20220722 15:42:43.239"/>
</iter>
<iter>
<var name="${i}">3</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:43.240" endtime="20220722 15:42:43.242"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.239" endtime="20220722 15:42:43.242"/>
</iter>
<iter>
<var name="${i}">4</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:43.243" endtime="20220722 15:42:43.245"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.243" endtime="20220722 15:42:43.245"/>
</iter>
<iter>
<var name="${i}">5</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:43.245" endtime="20220722 15:42:43.246"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.245" endtime="20220722 15:42:43.246"/>
</iter>
<status status="PASS" starttime="20220722 15:42:43.231" endtime="20220722 15:42:43.246"/>
</for>
<kw name="Log Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<doc>Logs the size and contents of the ``dictionary`` using given ``level``.</doc>
<msg timestamp="20220722 15:42:43.247" level="INFO">Dictionary size is 6 and it contains following items:
 TestResult: PASSED
ExpectedApi: 200
ExpectedRespone: None
Test Description: Validate การทำงานของ Services   กรณี Services ทำงานได้ปกติ
TestCaseNumber: HL1001_000
actualRespone: {"Services":[{"Status":"Up","ServiceName":"DatabaseSql","Message":""}],"Status":"Up"}</msg>
<status status="PASS" starttime="20220722 15:42:43.247" endtime="20220722 15:42:43.247"/>
</kw>
<msg timestamp="20220722 15:42:43.248" level="INFO">${data_test} = {' TestResult': 'PASSED', 'ExpectedApi': 200, 'ExpectedRespone': None, 'actualRespone': '{"Services":[{"Status":"Up","ServiceName":"DatabaseSql","Message":""}],"Status":"Up"}', 'TestCaseNumber': 'HL10...</msg>
<status status="PASS" starttime="20220722 15:42:43.181" endtime="20220722 15:42:43.248"/>
</kw>
<kw name="Prepare_Data_For_API_HealthCheck_Readiness" library="PrepareDataKeyword">
<var>${request}</var>
<arg>${data_test}</arg>
<kw name="Get Binary File" library="OperatingSystem">
<var>${json_string}</var>
<arg>${file_path_request}.json</arg>
<doc>Returns the contents of a specified file.</doc>
<msg timestamp="20220722 15:42:43.250" level="INFO" html="true">Getting file '&lt;a href="file://C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource\DataTest\API_CollectionPoint\CollectionPointList.json"&gt;C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource\DataTest\API_CollectionPoint\CollectionPointList.json&lt;/a&gt;'.</msg>
<msg timestamp="20220722 15:42:43.250" level="INFO">${json_string} = {}</msg>
<status status="PASS" starttime="20220722 15:42:43.249" endtime="20220722 15:42:43.250"/>
</kw>
<kw name="Log" library="BuiltIn">
<arg>${json_string}</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20220722 15:42:43.251" level="INFO">{}</msg>
<status status="PASS" starttime="20220722 15:42:43.251" endtime="20220722 15:42:43.251"/>
</kw>
<kw name="Evaluate" library="BuiltIn">
<var>${json}</var>
<arg>json.loads('''${json_string}''')</arg>
<arg>json</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<msg timestamp="20220722 15:42:43.253" level="INFO">${json} = {}</msg>
<status status="PASS" starttime="20220722 15:42:43.251" endtime="20220722 15:42:43.253"/>
</kw>
<kw name="Log Dictionary" library="Collections">
<arg>${json}</arg>
<doc>Logs the size and contents of the ``dictionary`` using given ``level``.</doc>
<msg timestamp="20220722 15:42:43.253" level="INFO">Dictionary is empty.</msg>
<status status="PASS" starttime="20220722 15:42:43.253" endtime="20220722 15:42:43.253"/>
</kw>
<kw name="Evaluate" library="BuiltIn">
<var>${json_string}</var>
<arg>json.dumps(${json})</arg>
<arg>json</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<msg timestamp="20220722 15:42:43.254" level="INFO">${json_string} = {}</msg>
<status status="PASS" starttime="20220722 15:42:43.253" endtime="20220722 15:42:43.254"/>
</kw>
<kw name="Log Many" library="BuiltIn">
<arg>${json_string}</arg>
<doc>Logs the given messages as separate entries using the INFO level.</doc>
<msg timestamp="20220722 15:42:43.254" level="INFO">{}</msg>
<status status="PASS" starttime="20220722 15:42:43.254" endtime="20220722 15:42:43.254"/>
</kw>
<kw name="Log" library="BuiltIn">
<arg>${json_string}</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20220722 15:42:43.254" level="INFO">{}</msg>
<status status="PASS" starttime="20220722 15:42:43.254" endtime="20220722 15:42:43.255"/>
</kw>
<msg timestamp="20220722 15:42:43.255" level="INFO">${request} = {}</msg>
<status status="PASS" starttime="20220722 15:42:43.248" endtime="20220722 15:42:43.255"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<var>${data}</var>
<arg>${rowNo} == 2</arg>
<arg>Validation_API_HealthCheck_Readiness</arg>
<arg>${request}</arg>
<arg>${statusCode}</arg>
<arg>${rowNo}</arg>
<arg>ELSE</arg>
<arg>Validation_API_HealthCheck_Readiness_Fail</arg>
<arg>${request}</arg>
<arg>${statusCode}</arg>
<arg>${rowNo}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="Validation_API_HealthCheck_Readiness" library="API_HealthCheck">
<arg>${request}</arg>
<arg>${statusCode}</arg>
<arg>${rowNo}</arg>
<kw name="Create Session" library="RequestsLibrary">
<arg>HealthCheck_Readiness</arg>
<arg>${HOST_NAME}</arg>
<arg>verify=${True}</arg>
<doc>Create Session: create a HTTP session to a server</doc>
<msg timestamp="20220722 15:42:43.257" level="INFO">Creating Session using : alias=HealthCheck_Readiness, url=https://viriyah-pdpa-api.azurewebsites.net, headers={},                     cookies={}, auth=None, timeout=None, proxies=None, verify=True,                     debug=0 </msg>
<status status="PASS" starttime="20220722 15:42:43.256" endtime="20220722 15:42:43.257"/>
</kw>
<kw name="Create Dictionary" library="BuiltIn">
<var>${HEADER_HEALTHCHECK_READINESS}</var>
<arg>Authorization=${token}</arg>
<arg>Content-Type=application/json</arg>
<arg>Accept=application/json</arg>
<doc>Creates and returns a dictionary based on the given ``items``.</doc>
<msg timestamp="20220722 15:42:43.257" level="INFO">${HEADER_HEALTHCHECK_READINESS} = {'Authorization': 'bearer 0CktjiNAS3gzU2r47fNTwIw6Rx4d_iqaeOMWXwtn52YPGQKR270KRONZ5fpBUYG7cokhhuD_J5oPYL42_PXtm6UcPPaFvXoyVwReaqt6c7Zj3_oAUm30pPQweZTzzAqEc6SXUIdnsUcFRXpBXnX5nG1ffFnar2vJSovElso6XQnDml...</msg>
<status status="PASS" starttime="20220722 15:42:43.257" endtime="20220722 15:42:43.257"/>
</kw>
<kw name="GET On Session" library="RequestsLibrary">
<var>${response}</var>
<arg>HealthCheck_Readiness</arg>
<arg>${API_HEALTHCHECK_READINESS['${ENV}']}</arg>
<arg>data=${request}</arg>
<arg>headers=${HEADER_HEALTHCHECK_READINESS}</arg>
<arg>expected_status=${statusCode}</arg>
<doc>Sends a GET request on a previously created HTTP Session.</doc>
<msg timestamp="20220722 15:42:43.565" level="INFO">GET Request : url=https://viriyah-pdpa-api.azurewebsites.net/api/health/readiness 
 path_url=/api/health/readiness 
 headers={'User-Agent': 'python-requests/2.28.0', 'Accept-Encoding': 'gzip, deflate', 'Accept': 'application/json', 'Connection': 'keep-alive', 'Authorization': 'bearer 0CktjiNAS3gzU2r47fNTwIw6Rx4d_iqaeOMWXwtn52YPGQKR270KRONZ5fpBUYG7cokhhuD_J5oPYL42_PXtm6UcPPaFvXoyVwReaqt6c7Zj3_oAUm30pPQweZTzzAqEc6SXUIdnsUcFRXpBXnX5nG1ffFnar2vJSovElso6XQnDmltYYJqNzN9D2VyV4yHpVa66SggCJ-xLPmVMa04DpUAIV7zaqVW0nJ7UvEua1cCPLDSian_7n12yyyDi50sLM-Mzgoi3VdUG0jztf_IL0QyoPhd4WKgSqsZJkrHzDFI', 'Content-Type': 'application/json', 'Content-Length': '2'} 
 body={} 
 </msg>
<msg timestamp="20220722 15:42:43.566" level="INFO">GET Response : url=https://viriyah-pdpa-api.azurewebsites.net/api/health/readiness 
 status=200, reason=OK 
 headers={'Content-Length': '180', 'Content-Type': 'application/json; charset=utf-8', 'Date': 'Fri, 22 Jul 2022 08:42:42 GMT', 'Server': 'Microsoft-IIS/10.0', 'Cache-Control': 'no-cache', 'Content-Encoding': 'gzip', 'Expires': '-1', 'Pragma': 'no-cache', 'Set-Cookie': 'ARRAffinity=b4313bdd91804439d7049c28e075e5fe38cdf75951b4356e26b1e09bca34d54c;Path=/;HttpOnly;Secure;Domain=viriyah-pdpa-api.azurewebsites.net, ARRAffinitySameSite=b4313bdd91804439d7049c28e075e5fe38cdf75951b4356e26b1e09bca34d54c;Path=/;HttpOnly;SameSite=None;Secure;Domain=viriyah-pdpa-api.azurewebsites.net', 'Vary': 'Accept-Encoding', 'X-AspNet-Version': '4.0.30319', 'X-Powered-By': 'ASP.NET'} 
 body={"Services":[{"Status":"Up","ServiceName":"DatabaseSql","Message":""}],"Status":"Up"} 
 </msg>
<msg timestamp="20220722 15:42:43.566" level="INFO">${response} = &lt;Response [200]&gt;</msg>
<status status="PASS" starttime="20220722 15:42:43.258" endtime="20220722 15:42:43.566"/>
</kw>
<kw name="Log Many" library="BuiltIn">
<arg>${response.text}</arg>
<doc>Logs the given messages as separate entries using the INFO level.</doc>
<msg timestamp="20220722 15:42:43.567" level="INFO">{"Services":[{"Status":"Up","ServiceName":"DatabaseSql","Message":""}],"Status":"Up"}</msg>
<status status="PASS" starttime="20220722 15:42:43.566" endtime="20220722 15:42:43.567"/>
</kw>
<kw name="Convert String to JSON" library="JSONLibrary">
<var>${json}</var>
<arg>${response.text}</arg>
<doc>Convert String to JSON object</doc>
<msg timestamp="20220722 15:42:43.568" level="INFO">${json} = {'Services': [{'Status': 'Up', 'ServiceName': 'DatabaseSql', 'Message': ''}], 'Status': 'Up'}</msg>
<status status="PASS" starttime="20220722 15:42:43.567" endtime="20220722 15:42:43.568"/>
</kw>
<kw name="Should Be Equal As Strings" library="BuiltIn">
<arg>${statusCode}</arg>
<arg>${response.status_code}</arg>
<doc>Fails if objects are unequal after converting them to strings.</doc>
<msg timestamp="20220722 15:42:43.569" level="INFO">Argument types are:
&lt;class 'str'&gt;
&lt;class 'int'&gt;</msg>
<status status="PASS" starttime="20220722 15:42:43.568" endtime="20220722 15:42:43.569"/>
</kw>
<kw name="Set Test Variable" library="BuiltIn">
<arg>${actual}</arg>
<arg>${response.text}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<msg timestamp="20220722 15:42:43.571" level="INFO">${actual} = {"Services":[{"Status":"Up","ServiceName":"DatabaseSql","Message":""}],"Status":"Up"}</msg>
<status status="PASS" starttime="20220722 15:42:43.569" endtime="20220722 15:42:43.571"/>
</kw>
<kw name="Run Keyword And Return Status" library="BuiltIn">
<var>${status}</var>
<arg>Should Be Equal As Strings</arg>
<arg>${statusCode}</arg>
<arg>${response.status_code}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<kw name="Should Be Equal As Strings" library="BuiltIn">
<arg>${statusCode}</arg>
<arg>${response.status_code}</arg>
<doc>Fails if objects are unequal after converting them to strings.</doc>
<msg timestamp="20220722 15:42:43.571" level="INFO">Argument types are:
&lt;class 'str'&gt;
&lt;class 'int'&gt;</msg>
<status status="PASS" starttime="20220722 15:42:43.571" endtime="20220722 15:42:43.572"/>
</kw>
<msg timestamp="20220722 15:42:43.572" level="INFO">${status} = True</msg>
<status status="PASS" starttime="20220722 15:42:43.571" endtime="20220722 15:42:43.572"/>
</kw>
<kw name="Write_Result_Status_To_Excel_HealthCheck" library="ExcelKeyword">
<arg>${EXCEL_NAME}</arg>
<arg>${SHEET_NAME}</arg>
<arg>${rowNo}</arg>
<arg>${status}</arg>
<kw name="Open Excel Document" library="ExcelLibraryV2">
<arg>${fileExcel}</arg>
<arg>Test</arg>
<doc>Opens xlsx document file.</doc>
<status status="PASS" starttime="20220722 15:42:43.572" endtime="20220722 15:42:43.595"/>
</kw>
<kw name="Log" library="BuiltIn">
<arg>${status}</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20220722 15:42:43.595" level="INFO">True</msg>
<status status="PASS" starttime="20220722 15:42:43.595" endtime="20220722 15:42:43.595"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>${status}==True</arg>
<arg>Write Excel Cell</arg>
<arg>row_num=${rowNo}</arg>
<arg>col_num=1</arg>
<arg>value=PASSED</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="Write Excel Cell" library="ExcelLibraryV2">
<arg>row_num=${rowNo}</arg>
<arg>col_num=1</arg>
<arg>value=PASSED</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Writes value to the cell.</doc>
<status status="PASS" starttime="20220722 15:42:43.595" endtime="20220722 15:42:43.596"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.595" endtime="20220722 15:42:43.596"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>${status}==False</arg>
<arg>Write Excel Cell</arg>
<arg>row_num=${rowNo}</arg>
<arg>col_num=1</arg>
<arg>value=FAILED</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" starttime="20220722 15:42:43.596" endtime="20220722 15:42:43.596"/>
</kw>
<kw name="Write Excel Cell" library="ExcelLibraryV2">
<arg>row_num=${rowNo}</arg>
<arg>col_num=4</arg>
<arg>value=${actual}</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Writes value to the cell.</doc>
<status status="PASS" starttime="20220722 15:42:43.596" endtime="20220722 15:42:43.596"/>
</kw>
<kw name="Save Excel Document" library="ExcelLibraryV2">
<arg>${fileExcel}</arg>
<doc>Saves the current document to disk.</doc>
<status status="PASS" starttime="20220722 15:42:43.596" endtime="20220722 15:42:43.640"/>
</kw>
<kw name="Close All Excel Documents" library="ExcelLibraryV2">
<doc>Closes all opened documents.</doc>
<status status="PASS" starttime="20220722 15:42:43.640" endtime="20220722 15:42:43.641"/>
</kw>
<kw name="Close All Excel Documents" library="ExcelLibraryV2" type="TEARDOWN">
<doc>Closes all opened documents.</doc>
<status status="PASS" starttime="20220722 15:42:43.641" endtime="20220722 15:42:43.641"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.572" endtime="20220722 15:42:43.641"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>${status}==False</arg>
<arg>Log</arg>
<arg>Fail</arg>
<arg>ELSE IF</arg>
<arg>${status}==True</arg>
<arg>Log</arg>
<arg>${actual}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="Log" library="BuiltIn">
<arg>${actual}</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20220722 15:42:43.641" level="INFO">{"Services":[{"Status":"Up","ServiceName":"DatabaseSql","Message":""}],"Status":"Up"}</msg>
<status status="PASS" starttime="20220722 15:42:43.641" endtime="20220722 15:42:43.641"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.641" endtime="20220722 15:42:43.641"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.256" endtime="20220722 15:42:43.641"/>
</kw>
<msg timestamp="20220722 15:42:43.642" level="INFO">${data} = None</msg>
<status status="PASS" starttime="20220722 15:42:43.255" endtime="20220722 15:42:43.642"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.179" endtime="20220722 15:42:43.642"/>
</kw>
<kw name="Close Browser" library="Selenium2Library" type="TEARDOWN">
<doc>Closes the current browser.</doc>
<status status="PASS" starttime="20220722 15:42:43.642" endtime="20220722 15:42:43.642"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.176" endtime="20220722 15:42:43.643"/>
</test>
<test id="s1-t2" name="HealthCheck Readiness Handling" line="13">
<kw name="Run Keywords" library="BuiltIn" type="SETUP">
<arg>Set Test Variable</arg>
<arg>${EXCEL_NAME}</arg>
<arg>${EXCEL_2C2P_PAYMENT}</arg>
<arg>AND</arg>
<arg>Set Test Variable</arg>
<arg>${SHEET_NAME}</arg>
<arg>${SHEET_HealthCheckReadiness}</arg>
<doc>Executes all the given keywords in a sequence.</doc>
<kw name="Set Test Variable" library="BuiltIn">
<arg>${EXCEL_NAME}</arg>
<arg>${EXCEL_2C2P_PAYMENT}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<msg timestamp="20220722 15:42:43.646" level="INFO">${EXCEL_NAME} = ./TestResource/DataTest/Excel_Script/PDPA_Script.xlsx</msg>
<status status="PASS" starttime="20220722 15:42:43.645" endtime="20220722 15:42:43.646"/>
</kw>
<kw name="Set Test Variable" library="BuiltIn">
<arg>${SHEET_NAME}</arg>
<arg>${SHEET_HealthCheckReadiness}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<msg timestamp="20220722 15:42:43.647" level="INFO">${SHEET_NAME} = HealthCheckReadiness</msg>
<status status="PASS" starttime="20220722 15:42:43.646" endtime="20220722 15:42:43.647"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.645" endtime="20220722 15:42:43.647"/>
</kw>
<kw name="API_HealthCheck_Readiness" library="API_HealthCheck">
<arg>3</arg>
<arg>404</arg>
<arg>HL1002_200</arg>
<kw name="Generate_File_Path_Request" library="PDPA_Keyword">
<arg>${JSON_CollectionPoint}</arg>
<doc>- สร้าง path สำหรับไฟล์ request เพื่อให้ใช้ได้ทุกๆเครื่อง</doc>
<kw name="Remove String" library="String">
<var>${NEWDIR}</var>
<arg>C:\\Users\\niranl\\OneDrive - The viriyah Insurance\\Desktop\\PDPA\\TestResource\\Keywords\\API_Keyword</arg>
<arg>${/}Keywords${/}API_Keyword</arg>
<doc>Removes all ``removables`` from the given ``string``.</doc>
<msg timestamp="20220722 15:42:43.649" level="INFO">${NEWDIR} = C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource</msg>
<status status="PASS" starttime="20220722 15:42:43.648" endtime="20220722 15:42:43.649"/>
</kw>
<kw name="Catenate" library="BuiltIn">
<var>${file_path_request}</var>
<arg>SEPARATOR=${/}</arg>
<arg>${NEWDIR}${/}DataTest${/}${path_request}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<msg timestamp="20220722 15:42:43.649" level="INFO">${file_path_request} = C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource\DataTest\./API_CollectionPoint/CollectionPointList</msg>
<status status="PASS" starttime="20220722 15:42:43.649" endtime="20220722 15:42:43.649"/>
</kw>
<kw name="Set Suite Variable" library="BuiltIn">
<arg>${path_request}</arg>
<doc>Makes a variable available everywhere within the scope of the current suite.</doc>
<msg timestamp="20220722 15:42:43.650" level="INFO">${path_request} = ./API_CollectionPoint/CollectionPointList</msg>
<status status="PASS" starttime="20220722 15:42:43.649" endtime="20220722 15:42:43.650"/>
</kw>
<kw name="Set Suite Variable" library="BuiltIn">
<arg>${file_path_request}</arg>
<doc>Makes a variable available everywhere within the scope of the current suite.</doc>
<msg timestamp="20220722 15:42:43.650" level="INFO">${file_path_request} = C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource\DataTest\./API_CollectionPoint/CollectionPointList</msg>
<status status="PASS" starttime="20220722 15:42:43.650" endtime="20220722 15:42:43.650"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.648" endtime="20220722 15:42:43.650"/>
</kw>
<kw name="Read_Excel_For_Test" library="ExcelKeyword">
<var>${data_test}</var>
<arg>${EXCEL_NAME}</arg>
<arg>${SHEET_NAME}</arg>
<arg>${rowNo}</arg>
<kw name="Open Excel Document" library="ExcelLibraryV2">
<arg>${fileExcel}</arg>
<arg>Test</arg>
<arg>True</arg>
<doc>Opens xlsx document file.</doc>
<status status="PASS" starttime="20220722 15:42:43.651" endtime="20220722 15:42:43.707"/>
</kw>
<kw name="Get List Sheet Names" library="ExcelLibraryV2">
<var>${sheets}</var>
<doc>Returns a list of sheet names in the current document.</doc>
<msg timestamp="20220722 15:42:43.707" level="INFO">${sheets} = ['CollectionPointList', 'CollectionPointInfo', 'GeneralConsentList', 'GeneralConsentSubmit', 'HealthCheckLiveness', 'HealthCheckReadiness']</msg>
<status status="PASS" starttime="20220722 15:42:43.707" endtime="20220722 15:42:43.707"/>
</kw>
<kw name="List Should Contain Value" library="Collections">
<arg>${sheets}</arg>
<arg>${sheetName}</arg>
<doc>Fails if the ``value`` is not found from ``list``.</doc>
<status status="PASS" starttime="20220722 15:42:43.707" endtime="20220722 15:42:43.708"/>
</kw>
<kw name="Read Excel Row" library="ExcelLibraryV2">
<var>@{HEAD}</var>
<arg>row_num=1</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Returns content of a row from the current sheet of the document.</doc>
<msg timestamp="20220722 15:42:43.708" level="INFO">@{HEAD} = [  TestResult | ExpectedApi | ExpectedRespone | actualRespone | TestCaseNumber | Test Description ]</msg>
<status status="PASS" starttime="20220722 15:42:43.708" endtime="20220722 15:42:43.708"/>
</kw>
<kw name="Read Excel Row" library="ExcelLibraryV2">
<var>@{DATA}</var>
<arg>row_num=${rowNo}</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Returns content of a row from the current sheet of the document.</doc>
<msg timestamp="20220722 15:42:43.709" level="INFO">@{DATA} = [ PASSED | 404 | None | {"Message":"No HTTP resource was found that matches the request URI 'https://viriyah-pdpa-api.azurewebsites.net/api/health/readinessAA'.","MessageDetail":"No type was found tha...</msg>
<status status="PASS" starttime="20220722 15:42:43.708" endtime="20220722 15:42:43.709"/>
</kw>
<kw name="Log List" library="Collections">
<arg>${HEAD}</arg>
<doc>Logs the length and contents of the ``list`` using given ``level``.</doc>
<msg timestamp="20220722 15:42:43.709" level="INFO">List length is 6 and it contains following items:
0:  TestResult
1: ExpectedApi
2: ExpectedRespone
3: actualRespone
4: TestCaseNumber
5: Test Description</msg>
<status status="PASS" starttime="20220722 15:42:43.709" endtime="20220722 15:42:43.709"/>
</kw>
<kw name="Log List" library="Collections">
<arg>${DATA}</arg>
<doc>Logs the length and contents of the ``list`` using given ``level``.</doc>
<msg timestamp="20220722 15:42:43.709" level="INFO">List length is 6 and it contains following items:
0: PASSED
1: 404
2: None
3: {"Message":"No HTTP resource was found that matches the request URI 'https://viriyah-pdpa-api.azurewebsites.net/api/health/readinessAA'.","MessageDetail":"No type was found that matches the controller named 'health'."}
4: HR1002_200
5: URL  ไม่ถูกต้อง </msg>
<status status="PASS" starttime="20220722 15:42:43.709" endtime="20220722 15:42:43.709"/>
</kw>
<kw name="Close All Excel Documents" library="ExcelLibraryV2">
<doc>Closes all opened documents.</doc>
<status status="PASS" starttime="20220722 15:42:43.710" endtime="20220722 15:42:43.710"/>
</kw>
<kw name="Create Dictionary" library="BuiltIn">
<var>${Test_Data}</var>
<doc>Creates and returns a dictionary based on the given ``items``.</doc>
<msg timestamp="20220722 15:42:43.711" level="INFO">${Test_Data} = {}</msg>
<status status="PASS" starttime="20220722 15:42:43.710" endtime="20220722 15:42:43.711"/>
</kw>
<kw name="Get Length" library="BuiltIn">
<var>${length}</var>
<arg>${DATA}</arg>
<doc>Returns and logs the length of the given item as an integer.</doc>
<msg timestamp="20220722 15:42:43.711" level="INFO">Length is 6</msg>
<msg timestamp="20220722 15:42:43.711" level="INFO">${length} = 6</msg>
<status status="PASS" starttime="20220722 15:42:43.711" endtime="20220722 15:42:43.711"/>
</kw>
<for flavor="IN RANGE">
<var>${i}</var>
<value>0</value>
<value>${length}</value>
<iter>
<var name="${i}">0</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:43.712" endtime="20220722 15:42:43.713"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.712" endtime="20220722 15:42:43.713"/>
</iter>
<iter>
<var name="${i}">1</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:43.713" endtime="20220722 15:42:43.714"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.713" endtime="20220722 15:42:43.714"/>
</iter>
<iter>
<var name="${i}">2</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:43.715" endtime="20220722 15:42:43.716"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.714" endtime="20220722 15:42:43.716"/>
</iter>
<iter>
<var name="${i}">3</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:43.717" endtime="20220722 15:42:43.719"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.717" endtime="20220722 15:42:43.719"/>
</iter>
<iter>
<var name="${i}">4</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:43.719" endtime="20220722 15:42:43.722"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.719" endtime="20220722 15:42:43.722"/>
</iter>
<iter>
<var name="${i}">5</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:43.722" endtime="20220722 15:42:43.725"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.722" endtime="20220722 15:42:43.725"/>
</iter>
<status status="PASS" starttime="20220722 15:42:43.711" endtime="20220722 15:42:43.725"/>
</for>
<kw name="Log Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<doc>Logs the size and contents of the ``dictionary`` using given ``level``.</doc>
<msg timestamp="20220722 15:42:43.728" level="INFO">Dictionary size is 6 and it contains following items:
 TestResult: PASSED
ExpectedApi: 404
ExpectedRespone: None
Test Description: URL  ไม่ถูกต้อง 
TestCaseNumber: HR1002_200
actualRespone: {"Message":"No HTTP resource was found that matches the request URI 'https://viriyah-pdpa-api.azurewebsites.net/api/health/readinessAA'.","MessageDetail":"No type was found that matches the controller named 'health'."}</msg>
<status status="PASS" starttime="20220722 15:42:43.726" endtime="20220722 15:42:43.728"/>
</kw>
<msg timestamp="20220722 15:42:43.728" level="INFO">${data_test} = {' TestResult': 'PASSED', 'ExpectedApi': 404, 'ExpectedRespone': None, 'actualRespone': '{"Message":"No HTTP resource was found that matches the request URI \'https://viriyah-pdpa-api.azurewebsites.ne...</msg>
<status status="PASS" starttime="20220722 15:42:43.650" endtime="20220722 15:42:43.728"/>
</kw>
<kw name="Prepare_Data_For_API_HealthCheck_Readiness" library="PrepareDataKeyword">
<var>${request}</var>
<arg>${data_test}</arg>
<kw name="Get Binary File" library="OperatingSystem">
<var>${json_string}</var>
<arg>${file_path_request}.json</arg>
<doc>Returns the contents of a specified file.</doc>
<msg timestamp="20220722 15:42:43.729" level="INFO" html="true">Getting file '&lt;a href="file://C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource\DataTest\API_CollectionPoint\CollectionPointList.json"&gt;C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource\DataTest\API_CollectionPoint\CollectionPointList.json&lt;/a&gt;'.</msg>
<msg timestamp="20220722 15:42:43.729" level="INFO">${json_string} = {}</msg>
<status status="PASS" starttime="20220722 15:42:43.729" endtime="20220722 15:42:43.729"/>
</kw>
<kw name="Log" library="BuiltIn">
<arg>${json_string}</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20220722 15:42:43.730" level="INFO">{}</msg>
<status status="PASS" starttime="20220722 15:42:43.729" endtime="20220722 15:42:43.730"/>
</kw>
<kw name="Evaluate" library="BuiltIn">
<var>${json}</var>
<arg>json.loads('''${json_string}''')</arg>
<arg>json</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<msg timestamp="20220722 15:42:43.730" level="INFO">${json} = {}</msg>
<status status="PASS" starttime="20220722 15:42:43.730" endtime="20220722 15:42:43.730"/>
</kw>
<kw name="Log Dictionary" library="Collections">
<arg>${json}</arg>
<doc>Logs the size and contents of the ``dictionary`` using given ``level``.</doc>
<msg timestamp="20220722 15:42:43.730" level="INFO">Dictionary is empty.</msg>
<status status="PASS" starttime="20220722 15:42:43.730" endtime="20220722 15:42:43.730"/>
</kw>
<kw name="Evaluate" library="BuiltIn">
<var>${json_string}</var>
<arg>json.dumps(${json})</arg>
<arg>json</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<msg timestamp="20220722 15:42:43.731" level="INFO">${json_string} = {}</msg>
<status status="PASS" starttime="20220722 15:42:43.731" endtime="20220722 15:42:43.731"/>
</kw>
<kw name="Log Many" library="BuiltIn">
<arg>${json_string}</arg>
<doc>Logs the given messages as separate entries using the INFO level.</doc>
<msg timestamp="20220722 15:42:43.731" level="INFO">{}</msg>
<status status="PASS" starttime="20220722 15:42:43.731" endtime="20220722 15:42:43.731"/>
</kw>
<kw name="Log" library="BuiltIn">
<arg>${json_string}</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20220722 15:42:43.731" level="INFO">{}</msg>
<status status="PASS" starttime="20220722 15:42:43.731" endtime="20220722 15:42:43.731"/>
</kw>
<msg timestamp="20220722 15:42:43.731" level="INFO">${request} = {}</msg>
<status status="PASS" starttime="20220722 15:42:43.728" endtime="20220722 15:42:43.731"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<var>${data}</var>
<arg>${rowNo} == 2</arg>
<arg>Validation_API_HealthCheck_Readiness</arg>
<arg>${request}</arg>
<arg>${statusCode}</arg>
<arg>${rowNo}</arg>
<arg>ELSE</arg>
<arg>Validation_API_HealthCheck_Readiness_Fail</arg>
<arg>${request}</arg>
<arg>${statusCode}</arg>
<arg>${rowNo}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="Validation_API_HealthCheck_Readiness_Fail" library="API_HealthCheck">
<arg>${request}</arg>
<arg>${statusCode}</arg>
<arg>${rowNo}</arg>
<kw name="Create Session" library="RequestsLibrary">
<arg>HealthCheck_Readiness</arg>
<arg>${HOST_NAME}</arg>
<arg>verify=${True}</arg>
<doc>Create Session: create a HTTP session to a server</doc>
<msg timestamp="20220722 15:42:43.732" level="INFO">Creating Session using : alias=HealthCheck_Readiness, url=https://viriyah-pdpa-api.azurewebsites.net, headers={},                     cookies={}, auth=None, timeout=None, proxies=None, verify=True,                     debug=0 </msg>
<status status="PASS" starttime="20220722 15:42:43.732" endtime="20220722 15:42:43.732"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<var>${HEADER_HEALTHCHECK_READINESS}</var>
<arg>${rowNo} == 4</arg>
<arg>create dictionary</arg>
<arg>Content-Type=application/json</arg>
<arg>Accept=application/json</arg>
<arg>ELSE IF</arg>
<arg>${rowNo} == 5</arg>
<arg>create dictionary</arg>
<arg>Authorization=${empty}</arg>
<arg>Content-Type=application/json</arg>
<arg>Accept=application/json</arg>
<arg>ELSE IF</arg>
<arg>${rowNo} == 6</arg>
<arg>create dictionary</arg>
<arg>Authorization=${INVALID}</arg>
<arg>Content-Type=application/json</arg>
<arg>Accept=application/json</arg>
<arg>ELSE</arg>
<arg>create dictionary</arg>
<arg>Authorization=${token}</arg>
<arg>Content-Type=application/json</arg>
<arg>Accept=application/json</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="Create Dictionary" library="BuiltIn">
<arg>Authorization=${token}</arg>
<arg>Content-Type=application/json</arg>
<arg>Accept=application/json</arg>
<doc>Creates and returns a dictionary based on the given ``items``.</doc>
<status status="PASS" starttime="20220722 15:42:43.733" endtime="20220722 15:42:43.733"/>
</kw>
<msg timestamp="20220722 15:42:43.733" level="INFO">${HEADER_HEALTHCHECK_READINESS} = {'Authorization': 'bearer 0CktjiNAS3gzU2r47fNTwIw6Rx4d_iqaeOMWXwtn52YPGQKR270KRONZ5fpBUYG7cokhhuD_J5oPYL42_PXtm6UcPPaFvXoyVwReaqt6c7Zj3_oAUm30pPQweZTzzAqEc6SXUIdnsUcFRXpBXnX5nG1ffFnar2vJSovElso6XQnDml...</msg>
<status status="PASS" starttime="20220722 15:42:43.733" endtime="20220722 15:42:43.733"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<var>${response}</var>
<arg>${rowNo} == 3</arg>
<arg>GET On Session</arg>
<arg>HealthCheck_Readiness</arg>
<arg>${API_HEALTHCHECK_READINESS_ERROR['${ENV}']}</arg>
<arg>data=${request}</arg>
<arg>headers=${HEADER_HEALTHCHECK_READINESS}</arg>
<arg>expected_status=${statusCode}</arg>
<arg>ELSE</arg>
<arg>GET On Session</arg>
<arg>HealthCheck_Readiness</arg>
<arg>${API_HEALTHCHECK_READINESS['${ENV}']}</arg>
<arg>data=${request}</arg>
<arg>headers=${HEADER_HEALTHCHECK_READINESS}</arg>
<arg>expected_status=${statusCode}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="GET On Session" library="RequestsLibrary">
<arg>HealthCheck_Readiness</arg>
<arg>${API_HEALTHCHECK_READINESS_ERROR['${ENV}']}</arg>
<arg>data=${request}</arg>
<arg>headers=${HEADER_HEALTHCHECK_READINESS}</arg>
<arg>expected_status=${statusCode}</arg>
<doc>Sends a GET request on a previously created HTTP Session.</doc>
<msg timestamp="20220722 15:42:43.957" level="INFO">GET Request : url=https://viriyah-pdpa-api.azurewebsites.net/api/health/readinessAA 
 path_url=/api/health/readinessAA 
 headers={'User-Agent': 'python-requests/2.28.0', 'Accept-Encoding': 'gzip, deflate', 'Accept': 'application/json', 'Connection': 'keep-alive', 'Authorization': 'bearer 0CktjiNAS3gzU2r47fNTwIw6Rx4d_iqaeOMWXwtn52YPGQKR270KRONZ5fpBUYG7cokhhuD_J5oPYL42_PXtm6UcPPaFvXoyVwReaqt6c7Zj3_oAUm30pPQweZTzzAqEc6SXUIdnsUcFRXpBXnX5nG1ffFnar2vJSovElso6XQnDmltYYJqNzN9D2VyV4yHpVa66SggCJ-xLPmVMa04DpUAIV7zaqVW0nJ7UvEua1cCPLDSian_7n12yyyDi50sLM-Mzgoi3VdUG0jztf_IL0QyoPhd4WKgSqsZJkrHzDFI', 'Content-Type': 'application/json', 'Content-Length': '2'} 
 body={} 
 </msg>
<msg timestamp="20220722 15:42:43.957" level="INFO">GET Response : url=https://viriyah-pdpa-api.azurewebsites.net/api/health/readinessAA 
 status=404, reason=Not Found 
 headers={'Content-Length': '218', 'Content-Type': 'application/json; charset=utf-8', 'Date': 'Fri, 22 Jul 2022 08:42:42 GMT', 'Server': 'Microsoft-IIS/10.0', 'Cache-Control': 'no-cache', 'Expires': '-1', 'Pragma': 'no-cache', 'Set-Cookie': 'ARRAffinity=b4313bdd91804439d7049c28e075e5fe38cdf75951b4356e26b1e09bca34d54c;Path=/;HttpOnly;Secure;Domain=viriyah-pdpa-api.azurewebsites.net, ARRAffinitySameSite=b4313bdd91804439d7049c28e075e5fe38cdf75951b4356e26b1e09bca34d54c;Path=/;HttpOnly;SameSite=None;Secure;Domain=viriyah-pdpa-api.azurewebsites.net', 'X-AspNet-Version': '4.0.30319', 'X-Powered-By': 'ASP.NET'} 
 body={"Message":"No HTTP resource was found that matches the request URI 'https://viriyah-pdpa-api.azurewebsites.net/api/health/readinessAA'.","MessageDetail":"No type was found that matches the controller named 'health'."} 
 </msg>
<status status="PASS" starttime="20220722 15:42:43.733" endtime="20220722 15:42:43.957"/>
</kw>
<msg timestamp="20220722 15:42:43.957" level="INFO">${response} = &lt;Response [404]&gt;</msg>
<status status="PASS" starttime="20220722 15:42:43.733" endtime="20220722 15:42:43.957"/>
</kw>
<kw name="Log Many" library="BuiltIn">
<arg>${response.text}</arg>
<doc>Logs the given messages as separate entries using the INFO level.</doc>
<msg timestamp="20220722 15:42:43.959" level="INFO">{"Message":"No HTTP resource was found that matches the request URI 'https://viriyah-pdpa-api.azurewebsites.net/api/health/readinessAA'.","MessageDetail":"No type was found that matches the controller named 'health'."}</msg>
<status status="PASS" starttime="20220722 15:42:43.958" endtime="20220722 15:42:43.959"/>
</kw>
<kw name="Should Be Equal As Strings" library="BuiltIn">
<arg>${statusCode}</arg>
<arg>${response.status_code}</arg>
<doc>Fails if objects are unequal after converting them to strings.</doc>
<msg timestamp="20220722 15:42:43.960" level="INFO">Argument types are:
&lt;class 'str'&gt;
&lt;class 'int'&gt;</msg>
<status status="PASS" starttime="20220722 15:42:43.959" endtime="20220722 15:42:43.960"/>
</kw>
<kw name="Set Test Variable" library="BuiltIn">
<arg>${actual}</arg>
<arg>${response.text}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<msg timestamp="20220722 15:42:43.961" level="INFO">${actual} = {"Message":"No HTTP resource was found that matches the request URI 'https://viriyah-pdpa-api.azurewebsites.net/api/health/readinessAA'.","MessageDetail":"No type was found that matches the controller...</msg>
<status status="PASS" starttime="20220722 15:42:43.960" endtime="20220722 15:42:43.961"/>
</kw>
<kw name="Run Keyword And Return Status" library="BuiltIn">
<var>${status}</var>
<arg>Should Be Equal As Strings</arg>
<arg>${statusCode}</arg>
<arg>${response.status_code}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<kw name="Should Be Equal As Strings" library="BuiltIn">
<arg>${statusCode}</arg>
<arg>${response.status_code}</arg>
<doc>Fails if objects are unequal after converting them to strings.</doc>
<msg timestamp="20220722 15:42:43.962" level="INFO">Argument types are:
&lt;class 'str'&gt;
&lt;class 'int'&gt;</msg>
<status status="PASS" starttime="20220722 15:42:43.962" endtime="20220722 15:42:43.962"/>
</kw>
<msg timestamp="20220722 15:42:43.962" level="INFO">${status} = True</msg>
<status status="PASS" starttime="20220722 15:42:43.961" endtime="20220722 15:42:43.962"/>
</kw>
<kw name="Write_Result_Status_To_Excel_HealthCheck" library="ExcelKeyword">
<arg>${EXCEL_NAME}</arg>
<arg>${SHEET_NAME}</arg>
<arg>${rowNo}</arg>
<arg>${status}</arg>
<kw name="Open Excel Document" library="ExcelLibraryV2">
<arg>${fileExcel}</arg>
<arg>Test</arg>
<doc>Opens xlsx document file.</doc>
<status status="PASS" starttime="20220722 15:42:43.962" endtime="20220722 15:42:43.984"/>
</kw>
<kw name="Log" library="BuiltIn">
<arg>${status}</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20220722 15:42:43.984" level="INFO">True</msg>
<status status="PASS" starttime="20220722 15:42:43.984" endtime="20220722 15:42:43.984"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>${status}==True</arg>
<arg>Write Excel Cell</arg>
<arg>row_num=${rowNo}</arg>
<arg>col_num=1</arg>
<arg>value=PASSED</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="Write Excel Cell" library="ExcelLibraryV2">
<arg>row_num=${rowNo}</arg>
<arg>col_num=1</arg>
<arg>value=PASSED</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Writes value to the cell.</doc>
<status status="PASS" starttime="20220722 15:42:43.985" endtime="20220722 15:42:43.985"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.985" endtime="20220722 15:42:43.985"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>${status}==False</arg>
<arg>Write Excel Cell</arg>
<arg>row_num=${rowNo}</arg>
<arg>col_num=1</arg>
<arg>value=FAILED</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" starttime="20220722 15:42:43.985" endtime="20220722 15:42:43.985"/>
</kw>
<kw name="Write Excel Cell" library="ExcelLibraryV2">
<arg>row_num=${rowNo}</arg>
<arg>col_num=4</arg>
<arg>value=${actual}</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Writes value to the cell.</doc>
<status status="PASS" starttime="20220722 15:42:43.985" endtime="20220722 15:42:43.986"/>
</kw>
<kw name="Save Excel Document" library="ExcelLibraryV2">
<arg>${fileExcel}</arg>
<doc>Saves the current document to disk.</doc>
<status status="PASS" starttime="20220722 15:42:43.986" endtime="20220722 15:42:44.027"/>
</kw>
<kw name="Close All Excel Documents" library="ExcelLibraryV2">
<doc>Closes all opened documents.</doc>
<status status="PASS" starttime="20220722 15:42:44.027" endtime="20220722 15:42:44.027"/>
</kw>
<kw name="Close All Excel Documents" library="ExcelLibraryV2" type="TEARDOWN">
<doc>Closes all opened documents.</doc>
<status status="PASS" starttime="20220722 15:42:44.027" endtime="20220722 15:42:44.027"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.962" endtime="20220722 15:42:44.027"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>${status}==False</arg>
<arg>Log</arg>
<arg>Fail</arg>
<arg>ELSE IF</arg>
<arg>${status}==True</arg>
<arg>Log</arg>
<arg>${actual}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="Log" library="BuiltIn">
<arg>${actual}</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20220722 15:42:44.028" level="INFO">{"Message":"No HTTP resource was found that matches the request URI 'https://viriyah-pdpa-api.azurewebsites.net/api/health/readinessAA'.","MessageDetail":"No type was found that matches the controller named 'health'."}</msg>
<status status="PASS" starttime="20220722 15:42:44.028" endtime="20220722 15:42:44.028"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.027" endtime="20220722 15:42:44.028"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.732" endtime="20220722 15:42:44.028"/>
</kw>
<msg timestamp="20220722 15:42:44.028" level="INFO">${data} = None</msg>
<status status="PASS" starttime="20220722 15:42:43.731" endtime="20220722 15:42:44.028"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.647" endtime="20220722 15:42:44.028"/>
</kw>
<kw name="Close Browser" library="Selenium2Library" type="TEARDOWN">
<doc>Closes the current browser.</doc>
<status status="PASS" starttime="20220722 15:42:44.029" endtime="20220722 15:42:44.029"/>
</kw>
<status status="PASS" starttime="20220722 15:42:43.644" endtime="20220722 15:42:44.029"/>
</test>
<test id="s1-t3" name="HealthCheck Readiness Missing" line="21">
<kw name="Run Keywords" library="BuiltIn" type="SETUP">
<arg>Set Test Variable</arg>
<arg>${EXCEL_NAME}</arg>
<arg>${EXCEL_2C2P_PAYMENT}</arg>
<arg>AND</arg>
<arg>Set Test Variable</arg>
<arg>${SHEET_NAME}</arg>
<arg>${SHEET_HealthCheckReadiness}</arg>
<doc>Executes all the given keywords in a sequence.</doc>
<kw name="Set Test Variable" library="BuiltIn">
<arg>${EXCEL_NAME}</arg>
<arg>${EXCEL_2C2P_PAYMENT}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<msg timestamp="20220722 15:42:44.032" level="INFO">${EXCEL_NAME} = ./TestResource/DataTest/Excel_Script/PDPA_Script.xlsx</msg>
<status status="PASS" starttime="20220722 15:42:44.031" endtime="20220722 15:42:44.032"/>
</kw>
<kw name="Set Test Variable" library="BuiltIn">
<arg>${SHEET_NAME}</arg>
<arg>${SHEET_HealthCheckReadiness}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<msg timestamp="20220722 15:42:44.033" level="INFO">${SHEET_NAME} = HealthCheckReadiness</msg>
<status status="PASS" starttime="20220722 15:42:44.032" endtime="20220722 15:42:44.033"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.031" endtime="20220722 15:42:44.033"/>
</kw>
<kw name="API_HealthCheck_Readiness" library="API_HealthCheck">
<arg>4</arg>
<arg>401</arg>
<arg>HL1004_400</arg>
<kw name="Generate_File_Path_Request" library="PDPA_Keyword">
<arg>${JSON_CollectionPoint}</arg>
<doc>- สร้าง path สำหรับไฟล์ request เพื่อให้ใช้ได้ทุกๆเครื่อง</doc>
<kw name="Remove String" library="String">
<var>${NEWDIR}</var>
<arg>C:\\Users\\niranl\\OneDrive - The viriyah Insurance\\Desktop\\PDPA\\TestResource\\Keywords\\API_Keyword</arg>
<arg>${/}Keywords${/}API_Keyword</arg>
<doc>Removes all ``removables`` from the given ``string``.</doc>
<msg timestamp="20220722 15:42:44.034" level="INFO">${NEWDIR} = C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource</msg>
<status status="PASS" starttime="20220722 15:42:44.034" endtime="20220722 15:42:44.034"/>
</kw>
<kw name="Catenate" library="BuiltIn">
<var>${file_path_request}</var>
<arg>SEPARATOR=${/}</arg>
<arg>${NEWDIR}${/}DataTest${/}${path_request}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<msg timestamp="20220722 15:42:44.035" level="INFO">${file_path_request} = C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource\DataTest\./API_CollectionPoint/CollectionPointList</msg>
<status status="PASS" starttime="20220722 15:42:44.035" endtime="20220722 15:42:44.035"/>
</kw>
<kw name="Set Suite Variable" library="BuiltIn">
<arg>${path_request}</arg>
<doc>Makes a variable available everywhere within the scope of the current suite.</doc>
<msg timestamp="20220722 15:42:44.035" level="INFO">${path_request} = ./API_CollectionPoint/CollectionPointList</msg>
<status status="PASS" starttime="20220722 15:42:44.035" endtime="20220722 15:42:44.035"/>
</kw>
<kw name="Set Suite Variable" library="BuiltIn">
<arg>${file_path_request}</arg>
<doc>Makes a variable available everywhere within the scope of the current suite.</doc>
<msg timestamp="20220722 15:42:44.036" level="INFO">${file_path_request} = C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource\DataTest\./API_CollectionPoint/CollectionPointList</msg>
<status status="PASS" starttime="20220722 15:42:44.036" endtime="20220722 15:42:44.036"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.034" endtime="20220722 15:42:44.036"/>
</kw>
<kw name="Read_Excel_For_Test" library="ExcelKeyword">
<var>${data_test}</var>
<arg>${EXCEL_NAME}</arg>
<arg>${SHEET_NAME}</arg>
<arg>${rowNo}</arg>
<kw name="Open Excel Document" library="ExcelLibraryV2">
<arg>${fileExcel}</arg>
<arg>Test</arg>
<arg>True</arg>
<doc>Opens xlsx document file.</doc>
<status status="PASS" starttime="20220722 15:42:44.037" endtime="20220722 15:42:44.071"/>
</kw>
<kw name="Get List Sheet Names" library="ExcelLibraryV2">
<var>${sheets}</var>
<doc>Returns a list of sheet names in the current document.</doc>
<msg timestamp="20220722 15:42:44.071" level="INFO">${sheets} = ['CollectionPointList', 'CollectionPointInfo', 'GeneralConsentList', 'GeneralConsentSubmit', 'HealthCheckLiveness', 'HealthCheckReadiness']</msg>
<status status="PASS" starttime="20220722 15:42:44.071" endtime="20220722 15:42:44.072"/>
</kw>
<kw name="List Should Contain Value" library="Collections">
<arg>${sheets}</arg>
<arg>${sheetName}</arg>
<doc>Fails if the ``value`` is not found from ``list``.</doc>
<status status="PASS" starttime="20220722 15:42:44.072" endtime="20220722 15:42:44.072"/>
</kw>
<kw name="Read Excel Row" library="ExcelLibraryV2">
<var>@{HEAD}</var>
<arg>row_num=1</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Returns content of a row from the current sheet of the document.</doc>
<msg timestamp="20220722 15:42:44.072" level="INFO">@{HEAD} = [  TestResult | ExpectedApi | ExpectedRespone | actualRespone | TestCaseNumber | Test Description ]</msg>
<status status="PASS" starttime="20220722 15:42:44.072" endtime="20220722 15:42:44.072"/>
</kw>
<kw name="Read Excel Row" library="ExcelLibraryV2">
<var>@{DATA}</var>
<arg>row_num=${rowNo}</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Returns content of a row from the current sheet of the document.</doc>
<msg timestamp="20220722 15:42:44.074" level="INFO">@{DATA} = [ PASSED | 401 | None | Unauthorized | HL1004_400 | Validate  การแสดงข้อมูล โดย Missing tag Parameter Header 
- Authorization   ]</msg>
<status status="PASS" starttime="20220722 15:42:44.072" endtime="20220722 15:42:44.074"/>
</kw>
<kw name="Log List" library="Collections">
<arg>${HEAD}</arg>
<doc>Logs the length and contents of the ``list`` using given ``level``.</doc>
<msg timestamp="20220722 15:42:44.074" level="INFO">List length is 6 and it contains following items:
0:  TestResult
1: ExpectedApi
2: ExpectedRespone
3: actualRespone
4: TestCaseNumber
5: Test Description</msg>
<status status="PASS" starttime="20220722 15:42:44.074" endtime="20220722 15:42:44.074"/>
</kw>
<kw name="Log List" library="Collections">
<arg>${DATA}</arg>
<doc>Logs the length and contents of the ``list`` using given ``level``.</doc>
<msg timestamp="20220722 15:42:44.074" level="INFO">List length is 6 and it contains following items:
0: PASSED
1: 401
2: None
3: Unauthorized
4: HL1004_400
5: Validate  การแสดงข้อมูล โดย Missing tag Parameter Header 
- Authorization  </msg>
<status status="PASS" starttime="20220722 15:42:44.074" endtime="20220722 15:42:44.074"/>
</kw>
<kw name="Close All Excel Documents" library="ExcelLibraryV2">
<doc>Closes all opened documents.</doc>
<status status="PASS" starttime="20220722 15:42:44.074" endtime="20220722 15:42:44.074"/>
</kw>
<kw name="Create Dictionary" library="BuiltIn">
<var>${Test_Data}</var>
<doc>Creates and returns a dictionary based on the given ``items``.</doc>
<msg timestamp="20220722 15:42:44.075" level="INFO">${Test_Data} = {}</msg>
<status status="PASS" starttime="20220722 15:42:44.074" endtime="20220722 15:42:44.075"/>
</kw>
<kw name="Get Length" library="BuiltIn">
<var>${length}</var>
<arg>${DATA}</arg>
<doc>Returns and logs the length of the given item as an integer.</doc>
<msg timestamp="20220722 15:42:44.075" level="INFO">Length is 6</msg>
<msg timestamp="20220722 15:42:44.075" level="INFO">${length} = 6</msg>
<status status="PASS" starttime="20220722 15:42:44.075" endtime="20220722 15:42:44.075"/>
</kw>
<for flavor="IN RANGE">
<var>${i}</var>
<value>0</value>
<value>${length}</value>
<iter>
<var name="${i}">0</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:44.075" endtime="20220722 15:42:44.080"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.075" endtime="20220722 15:42:44.080"/>
</iter>
<iter>
<var name="${i}">1</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:44.080" endtime="20220722 15:42:44.081"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.080" endtime="20220722 15:42:44.081"/>
</iter>
<iter>
<var name="${i}">2</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:44.081" endtime="20220722 15:42:44.082"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.081" endtime="20220722 15:42:44.082"/>
</iter>
<iter>
<var name="${i}">3</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:44.082" endtime="20220722 15:42:44.084"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.082" endtime="20220722 15:42:44.084"/>
</iter>
<iter>
<var name="${i}">4</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:44.084" endtime="20220722 15:42:44.085"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.084" endtime="20220722 15:42:44.085"/>
</iter>
<iter>
<var name="${i}">5</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:44.085" endtime="20220722 15:42:44.086"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.085" endtime="20220722 15:42:44.086"/>
</iter>
<status status="PASS" starttime="20220722 15:42:44.075" endtime="20220722 15:42:44.086"/>
</for>
<kw name="Log Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<doc>Logs the size and contents of the ``dictionary`` using given ``level``.</doc>
<msg timestamp="20220722 15:42:44.087" level="INFO">Dictionary size is 6 and it contains following items:
 TestResult: PASSED
ExpectedApi: 401
ExpectedRespone: None
Test Description: Validate  การแสดงข้อมูล โดย Missing tag Parameter Header 
- Authorization  
TestCaseNumber: HL1004_400
actualRespone: Unauthorized</msg>
<status status="PASS" starttime="20220722 15:42:44.086" endtime="20220722 15:42:44.087"/>
</kw>
<msg timestamp="20220722 15:42:44.087" level="INFO">${data_test} = {' TestResult': 'PASSED', 'ExpectedApi': 401, 'ExpectedRespone': None, 'actualRespone': 'Unauthorized', 'TestCaseNumber': 'HL1004_400', 'Test Description': 'Validate  การแสดงข้อมูล โดย Missing tag Par...</msg>
<status status="PASS" starttime="20220722 15:42:44.036" endtime="20220722 15:42:44.087"/>
</kw>
<kw name="Prepare_Data_For_API_HealthCheck_Readiness" library="PrepareDataKeyword">
<var>${request}</var>
<arg>${data_test}</arg>
<kw name="Get Binary File" library="OperatingSystem">
<var>${json_string}</var>
<arg>${file_path_request}.json</arg>
<doc>Returns the contents of a specified file.</doc>
<msg timestamp="20220722 15:42:44.087" level="INFO" html="true">Getting file '&lt;a href="file://C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource\DataTest\API_CollectionPoint\CollectionPointList.json"&gt;C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource\DataTest\API_CollectionPoint\CollectionPointList.json&lt;/a&gt;'.</msg>
<msg timestamp="20220722 15:42:44.087" level="INFO">${json_string} = {}</msg>
<status status="PASS" starttime="20220722 15:42:44.087" endtime="20220722 15:42:44.088"/>
</kw>
<kw name="Log" library="BuiltIn">
<arg>${json_string}</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20220722 15:42:44.088" level="INFO">{}</msg>
<status status="PASS" starttime="20220722 15:42:44.088" endtime="20220722 15:42:44.088"/>
</kw>
<kw name="Evaluate" library="BuiltIn">
<var>${json}</var>
<arg>json.loads('''${json_string}''')</arg>
<arg>json</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<msg timestamp="20220722 15:42:44.088" level="INFO">${json} = {}</msg>
<status status="PASS" starttime="20220722 15:42:44.088" endtime="20220722 15:42:44.088"/>
</kw>
<kw name="Log Dictionary" library="Collections">
<arg>${json}</arg>
<doc>Logs the size and contents of the ``dictionary`` using given ``level``.</doc>
<msg timestamp="20220722 15:42:44.089" level="INFO">Dictionary is empty.</msg>
<status status="PASS" starttime="20220722 15:42:44.088" endtime="20220722 15:42:44.089"/>
</kw>
<kw name="Evaluate" library="BuiltIn">
<var>${json_string}</var>
<arg>json.dumps(${json})</arg>
<arg>json</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<msg timestamp="20220722 15:42:44.089" level="INFO">${json_string} = {}</msg>
<status status="PASS" starttime="20220722 15:42:44.089" endtime="20220722 15:42:44.089"/>
</kw>
<kw name="Log Many" library="BuiltIn">
<arg>${json_string}</arg>
<doc>Logs the given messages as separate entries using the INFO level.</doc>
<msg timestamp="20220722 15:42:44.089" level="INFO">{}</msg>
<status status="PASS" starttime="20220722 15:42:44.089" endtime="20220722 15:42:44.089"/>
</kw>
<kw name="Log" library="BuiltIn">
<arg>${json_string}</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20220722 15:42:44.089" level="INFO">{}</msg>
<status status="PASS" starttime="20220722 15:42:44.089" endtime="20220722 15:42:44.089"/>
</kw>
<msg timestamp="20220722 15:42:44.089" level="INFO">${request} = {}</msg>
<status status="PASS" starttime="20220722 15:42:44.087" endtime="20220722 15:42:44.089"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<var>${data}</var>
<arg>${rowNo} == 2</arg>
<arg>Validation_API_HealthCheck_Readiness</arg>
<arg>${request}</arg>
<arg>${statusCode}</arg>
<arg>${rowNo}</arg>
<arg>ELSE</arg>
<arg>Validation_API_HealthCheck_Readiness_Fail</arg>
<arg>${request}</arg>
<arg>${statusCode}</arg>
<arg>${rowNo}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="Validation_API_HealthCheck_Readiness_Fail" library="API_HealthCheck">
<arg>${request}</arg>
<arg>${statusCode}</arg>
<arg>${rowNo}</arg>
<kw name="Create Session" library="RequestsLibrary">
<arg>HealthCheck_Readiness</arg>
<arg>${HOST_NAME}</arg>
<arg>verify=${True}</arg>
<doc>Create Session: create a HTTP session to a server</doc>
<msg timestamp="20220722 15:42:44.092" level="INFO">Creating Session using : alias=HealthCheck_Readiness, url=https://viriyah-pdpa-api.azurewebsites.net, headers={},                     cookies={}, auth=None, timeout=None, proxies=None, verify=True,                     debug=0 </msg>
<status status="PASS" starttime="20220722 15:42:44.090" endtime="20220722 15:42:44.092"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<var>${HEADER_HEALTHCHECK_READINESS}</var>
<arg>${rowNo} == 4</arg>
<arg>create dictionary</arg>
<arg>Content-Type=application/json</arg>
<arg>Accept=application/json</arg>
<arg>ELSE IF</arg>
<arg>${rowNo} == 5</arg>
<arg>create dictionary</arg>
<arg>Authorization=${empty}</arg>
<arg>Content-Type=application/json</arg>
<arg>Accept=application/json</arg>
<arg>ELSE IF</arg>
<arg>${rowNo} == 6</arg>
<arg>create dictionary</arg>
<arg>Authorization=${INVALID}</arg>
<arg>Content-Type=application/json</arg>
<arg>Accept=application/json</arg>
<arg>ELSE</arg>
<arg>create dictionary</arg>
<arg>Authorization=${token}</arg>
<arg>Content-Type=application/json</arg>
<arg>Accept=application/json</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="Create Dictionary" library="BuiltIn">
<arg>Content-Type=application/json</arg>
<arg>Accept=application/json</arg>
<doc>Creates and returns a dictionary based on the given ``items``.</doc>
<status status="PASS" starttime="20220722 15:42:44.092" endtime="20220722 15:42:44.092"/>
</kw>
<msg timestamp="20220722 15:42:44.092" level="INFO">${HEADER_HEALTHCHECK_READINESS} = {'Content-Type': 'application/json', 'Accept': 'application/json'}</msg>
<status status="PASS" starttime="20220722 15:42:44.092" endtime="20220722 15:42:44.092"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<var>${response}</var>
<arg>${rowNo} == 3</arg>
<arg>GET On Session</arg>
<arg>HealthCheck_Readiness</arg>
<arg>${API_HEALTHCHECK_READINESS_ERROR['${ENV}']}</arg>
<arg>data=${request}</arg>
<arg>headers=${HEADER_HEALTHCHECK_READINESS}</arg>
<arg>expected_status=${statusCode}</arg>
<arg>ELSE</arg>
<arg>GET On Session</arg>
<arg>HealthCheck_Readiness</arg>
<arg>${API_HEALTHCHECK_READINESS['${ENV}']}</arg>
<arg>data=${request}</arg>
<arg>headers=${HEADER_HEALTHCHECK_READINESS}</arg>
<arg>expected_status=${statusCode}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="GET On Session" library="RequestsLibrary">
<arg>HealthCheck_Readiness</arg>
<arg>${API_HEALTHCHECK_READINESS['${ENV}']}</arg>
<arg>data=${request}</arg>
<arg>headers=${HEADER_HEALTHCHECK_READINESS}</arg>
<arg>expected_status=${statusCode}</arg>
<doc>Sends a GET request on a previously created HTTP Session.</doc>
<msg timestamp="20220722 15:42:44.264" level="INFO">GET Request : url=https://viriyah-pdpa-api.azurewebsites.net/api/health/readiness 
 path_url=/api/health/readiness 
 headers={'User-Agent': 'python-requests/2.28.0', 'Accept-Encoding': 'gzip, deflate', 'Accept': 'application/json', 'Connection': 'keep-alive', 'Content-Type': 'application/json', 'Content-Length': '2'} 
 body={} 
 </msg>
<msg timestamp="20220722 15:42:44.265" level="INFO">GET Response : url=https://viriyah-pdpa-api.azurewebsites.net/api/health/readiness 
 status=401, reason=Unauthorized 
 headers={'Content-Length': '12', 'Content-Type': 'text/plain; charset=utf-8', 'Date': 'Fri, 22 Jul 2022 08:42:42 GMT', 'Server': 'Microsoft-IIS/10.0', 'Cache-Control': 'no-cache', 'Expires': '-1', 'Pragma': 'no-cache', 'Set-Cookie': 'ARRAffinity=b4313bdd91804439d7049c28e075e5fe38cdf75951b4356e26b1e09bca34d54c;Path=/;HttpOnly;Secure;Domain=viriyah-pdpa-api.azurewebsites.net, ARRAffinitySameSite=b4313bdd91804439d7049c28e075e5fe38cdf75951b4356e26b1e09bca34d54c;Path=/;HttpOnly;SameSite=None;Secure;Domain=viriyah-pdpa-api.azurewebsites.net', 'X-AspNet-Version': '4.0.30319', 'X-Powered-By': 'ASP.NET'} 
 body=Unauthorized 
 </msg>
<status status="PASS" starttime="20220722 15:42:44.093" endtime="20220722 15:42:44.265"/>
</kw>
<msg timestamp="20220722 15:42:44.265" level="INFO">${response} = &lt;Response [401]&gt;</msg>
<status status="PASS" starttime="20220722 15:42:44.093" endtime="20220722 15:42:44.265"/>
</kw>
<kw name="Log Many" library="BuiltIn">
<arg>${response.text}</arg>
<doc>Logs the given messages as separate entries using the INFO level.</doc>
<msg timestamp="20220722 15:42:44.265" level="INFO">Unauthorized</msg>
<status status="PASS" starttime="20220722 15:42:44.265" endtime="20220722 15:42:44.265"/>
</kw>
<kw name="Should Be Equal As Strings" library="BuiltIn">
<arg>${statusCode}</arg>
<arg>${response.status_code}</arg>
<doc>Fails if objects are unequal after converting them to strings.</doc>
<msg timestamp="20220722 15:42:44.266" level="INFO">Argument types are:
&lt;class 'str'&gt;
&lt;class 'int'&gt;</msg>
<status status="PASS" starttime="20220722 15:42:44.265" endtime="20220722 15:42:44.266"/>
</kw>
<kw name="Set Test Variable" library="BuiltIn">
<arg>${actual}</arg>
<arg>${response.text}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<msg timestamp="20220722 15:42:44.267" level="INFO">${actual} = Unauthorized</msg>
<status status="PASS" starttime="20220722 15:42:44.266" endtime="20220722 15:42:44.267"/>
</kw>
<kw name="Run Keyword And Return Status" library="BuiltIn">
<var>${status}</var>
<arg>Should Be Equal As Strings</arg>
<arg>${statusCode}</arg>
<arg>${response.status_code}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<kw name="Should Be Equal As Strings" library="BuiltIn">
<arg>${statusCode}</arg>
<arg>${response.status_code}</arg>
<doc>Fails if objects are unequal after converting them to strings.</doc>
<msg timestamp="20220722 15:42:44.268" level="INFO">Argument types are:
&lt;class 'str'&gt;
&lt;class 'int'&gt;</msg>
<status status="PASS" starttime="20220722 15:42:44.268" endtime="20220722 15:42:44.268"/>
</kw>
<msg timestamp="20220722 15:42:44.268" level="INFO">${status} = True</msg>
<status status="PASS" starttime="20220722 15:42:44.267" endtime="20220722 15:42:44.268"/>
</kw>
<kw name="Write_Result_Status_To_Excel_HealthCheck" library="ExcelKeyword">
<arg>${EXCEL_NAME}</arg>
<arg>${SHEET_NAME}</arg>
<arg>${rowNo}</arg>
<arg>${status}</arg>
<kw name="Open Excel Document" library="ExcelLibraryV2">
<arg>${fileExcel}</arg>
<arg>Test</arg>
<doc>Opens xlsx document file.</doc>
<status status="PASS" starttime="20220722 15:42:44.269" endtime="20220722 15:42:44.313"/>
</kw>
<kw name="Log" library="BuiltIn">
<arg>${status}</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20220722 15:42:44.314" level="INFO">True</msg>
<status status="PASS" starttime="20220722 15:42:44.313" endtime="20220722 15:42:44.314"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>${status}==True</arg>
<arg>Write Excel Cell</arg>
<arg>row_num=${rowNo}</arg>
<arg>col_num=1</arg>
<arg>value=PASSED</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="Write Excel Cell" library="ExcelLibraryV2">
<arg>row_num=${rowNo}</arg>
<arg>col_num=1</arg>
<arg>value=PASSED</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Writes value to the cell.</doc>
<status status="PASS" starttime="20220722 15:42:44.315" endtime="20220722 15:42:44.316"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.315" endtime="20220722 15:42:44.316"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>${status}==False</arg>
<arg>Write Excel Cell</arg>
<arg>row_num=${rowNo}</arg>
<arg>col_num=1</arg>
<arg>value=FAILED</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" starttime="20220722 15:42:44.316" endtime="20220722 15:42:44.316"/>
</kw>
<kw name="Write Excel Cell" library="ExcelLibraryV2">
<arg>row_num=${rowNo}</arg>
<arg>col_num=4</arg>
<arg>value=${actual}</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Writes value to the cell.</doc>
<status status="PASS" starttime="20220722 15:42:44.317" endtime="20220722 15:42:44.317"/>
</kw>
<kw name="Save Excel Document" library="ExcelLibraryV2">
<arg>${fileExcel}</arg>
<doc>Saves the current document to disk.</doc>
<status status="PASS" starttime="20220722 15:42:44.317" endtime="20220722 15:42:44.397"/>
</kw>
<kw name="Close All Excel Documents" library="ExcelLibraryV2">
<doc>Closes all opened documents.</doc>
<status status="PASS" starttime="20220722 15:42:44.397" endtime="20220722 15:42:44.397"/>
</kw>
<kw name="Close All Excel Documents" library="ExcelLibraryV2" type="TEARDOWN">
<doc>Closes all opened documents.</doc>
<status status="PASS" starttime="20220722 15:42:44.398" endtime="20220722 15:42:44.398"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.268" endtime="20220722 15:42:44.398"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>${status}==False</arg>
<arg>Log</arg>
<arg>Fail</arg>
<arg>ELSE IF</arg>
<arg>${status}==True</arg>
<arg>Log</arg>
<arg>${actual}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="Log" library="BuiltIn">
<arg>${actual}</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20220722 15:42:44.399" level="INFO">Unauthorized</msg>
<status status="PASS" starttime="20220722 15:42:44.399" endtime="20220722 15:42:44.399"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.398" endtime="20220722 15:42:44.399"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.090" endtime="20220722 15:42:44.399"/>
</kw>
<msg timestamp="20220722 15:42:44.399" level="INFO">${data} = None</msg>
<status status="PASS" starttime="20220722 15:42:44.089" endtime="20220722 15:42:44.399"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.034" endtime="20220722 15:42:44.399"/>
</kw>
<kw name="Close Browser" library="Selenium2Library" type="TEARDOWN">
<doc>Closes the current browser.</doc>
<status status="PASS" starttime="20220722 15:42:44.400" endtime="20220722 15:42:44.400"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.031" endtime="20220722 15:42:44.400"/>
</test>
<test id="s1-t4" name="HealthCheck Readiness Empty value" line="29">
<kw name="Run Keywords" library="BuiltIn" type="SETUP">
<arg>Set Test Variable</arg>
<arg>${EXCEL_NAME}</arg>
<arg>${EXCEL_2C2P_PAYMENT}</arg>
<arg>AND</arg>
<arg>Set Test Variable</arg>
<arg>${SHEET_NAME}</arg>
<arg>${SHEET_HealthCheckReadiness}</arg>
<doc>Executes all the given keywords in a sequence.</doc>
<kw name="Set Test Variable" library="BuiltIn">
<arg>${EXCEL_NAME}</arg>
<arg>${EXCEL_2C2P_PAYMENT}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<msg timestamp="20220722 15:42:44.405" level="INFO">${EXCEL_NAME} = ./TestResource/DataTest/Excel_Script/PDPA_Script.xlsx</msg>
<status status="PASS" starttime="20220722 15:42:44.403" endtime="20220722 15:42:44.405"/>
</kw>
<kw name="Set Test Variable" library="BuiltIn">
<arg>${SHEET_NAME}</arg>
<arg>${SHEET_HealthCheckReadiness}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<msg timestamp="20220722 15:42:44.408" level="INFO">${SHEET_NAME} = HealthCheckReadiness</msg>
<status status="PASS" starttime="20220722 15:42:44.406" endtime="20220722 15:42:44.408"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.402" endtime="20220722 15:42:44.408"/>
</kw>
<kw name="API_HealthCheck_Readiness" library="API_HealthCheck">
<arg>5</arg>
<arg>401</arg>
<arg>HL1005_500</arg>
<kw name="Generate_File_Path_Request" library="PDPA_Keyword">
<arg>${JSON_CollectionPoint}</arg>
<doc>- สร้าง path สำหรับไฟล์ request เพื่อให้ใช้ได้ทุกๆเครื่อง</doc>
<kw name="Remove String" library="String">
<var>${NEWDIR}</var>
<arg>C:\\Users\\niranl\\OneDrive - The viriyah Insurance\\Desktop\\PDPA\\TestResource\\Keywords\\API_Keyword</arg>
<arg>${/}Keywords${/}API_Keyword</arg>
<doc>Removes all ``removables`` from the given ``string``.</doc>
<msg timestamp="20220722 15:42:44.411" level="INFO">${NEWDIR} = C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource</msg>
<status status="PASS" starttime="20220722 15:42:44.411" endtime="20220722 15:42:44.411"/>
</kw>
<kw name="Catenate" library="BuiltIn">
<var>${file_path_request}</var>
<arg>SEPARATOR=${/}</arg>
<arg>${NEWDIR}${/}DataTest${/}${path_request}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<msg timestamp="20220722 15:42:44.412" level="INFO">${file_path_request} = C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource\DataTest\./API_CollectionPoint/CollectionPointList</msg>
<status status="PASS" starttime="20220722 15:42:44.411" endtime="20220722 15:42:44.412"/>
</kw>
<kw name="Set Suite Variable" library="BuiltIn">
<arg>${path_request}</arg>
<doc>Makes a variable available everywhere within the scope of the current suite.</doc>
<msg timestamp="20220722 15:42:44.412" level="INFO">${path_request} = ./API_CollectionPoint/CollectionPointList</msg>
<status status="PASS" starttime="20220722 15:42:44.412" endtime="20220722 15:42:44.412"/>
</kw>
<kw name="Set Suite Variable" library="BuiltIn">
<arg>${file_path_request}</arg>
<doc>Makes a variable available everywhere within the scope of the current suite.</doc>
<msg timestamp="20220722 15:42:44.413" level="INFO">${file_path_request} = C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource\DataTest\./API_CollectionPoint/CollectionPointList</msg>
<status status="PASS" starttime="20220722 15:42:44.412" endtime="20220722 15:42:44.413"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.411" endtime="20220722 15:42:44.413"/>
</kw>
<kw name="Read_Excel_For_Test" library="ExcelKeyword">
<var>${data_test}</var>
<arg>${EXCEL_NAME}</arg>
<arg>${SHEET_NAME}</arg>
<arg>${rowNo}</arg>
<kw name="Open Excel Document" library="ExcelLibraryV2">
<arg>${fileExcel}</arg>
<arg>Test</arg>
<arg>True</arg>
<doc>Opens xlsx document file.</doc>
<status status="PASS" starttime="20220722 15:42:44.413" endtime="20220722 15:42:44.500"/>
</kw>
<kw name="Get List Sheet Names" library="ExcelLibraryV2">
<var>${sheets}</var>
<doc>Returns a list of sheet names in the current document.</doc>
<msg timestamp="20220722 15:42:44.500" level="INFO">${sheets} = ['CollectionPointList', 'CollectionPointInfo', 'GeneralConsentList', 'GeneralConsentSubmit', 'HealthCheckLiveness', 'HealthCheckReadiness']</msg>
<status status="PASS" starttime="20220722 15:42:44.500" endtime="20220722 15:42:44.500"/>
</kw>
<kw name="List Should Contain Value" library="Collections">
<arg>${sheets}</arg>
<arg>${sheetName}</arg>
<doc>Fails if the ``value`` is not found from ``list``.</doc>
<status status="PASS" starttime="20220722 15:42:44.500" endtime="20220722 15:42:44.500"/>
</kw>
<kw name="Read Excel Row" library="ExcelLibraryV2">
<var>@{HEAD}</var>
<arg>row_num=1</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Returns content of a row from the current sheet of the document.</doc>
<msg timestamp="20220722 15:42:44.501" level="INFO">@{HEAD} = [  TestResult | ExpectedApi | ExpectedRespone | actualRespone | TestCaseNumber | Test Description ]</msg>
<status status="PASS" starttime="20220722 15:42:44.501" endtime="20220722 15:42:44.501"/>
</kw>
<kw name="Read Excel Row" library="ExcelLibraryV2">
<var>@{DATA}</var>
<arg>row_num=${rowNo}</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Returns content of a row from the current sheet of the document.</doc>
<msg timestamp="20220722 15:42:44.501" level="INFO">@{DATA} = [ PASSED | 401 | None | Unauthorized | HR1005_500 | Validate   การแสดงข้อมูลสถานะ โดย Empty value Parameter Header 
- Authorization   ]</msg>
<status status="PASS" starttime="20220722 15:42:44.501" endtime="20220722 15:42:44.501"/>
</kw>
<kw name="Log List" library="Collections">
<arg>${HEAD}</arg>
<doc>Logs the length and contents of the ``list`` using given ``level``.</doc>
<msg timestamp="20220722 15:42:44.502" level="INFO">List length is 6 and it contains following items:
0:  TestResult
1: ExpectedApi
2: ExpectedRespone
3: actualRespone
4: TestCaseNumber
5: Test Description</msg>
<status status="PASS" starttime="20220722 15:42:44.501" endtime="20220722 15:42:44.502"/>
</kw>
<kw name="Log List" library="Collections">
<arg>${DATA}</arg>
<doc>Logs the length and contents of the ``list`` using given ``level``.</doc>
<msg timestamp="20220722 15:42:44.502" level="INFO">List length is 6 and it contains following items:
0: PASSED
1: 401
2: None
3: Unauthorized
4: HR1005_500
5: Validate   การแสดงข้อมูลสถานะ โดย Empty value Parameter Header 
- Authorization  </msg>
<status status="PASS" starttime="20220722 15:42:44.502" endtime="20220722 15:42:44.502"/>
</kw>
<kw name="Close All Excel Documents" library="ExcelLibraryV2">
<doc>Closes all opened documents.</doc>
<status status="PASS" starttime="20220722 15:42:44.502" endtime="20220722 15:42:44.502"/>
</kw>
<kw name="Create Dictionary" library="BuiltIn">
<var>${Test_Data}</var>
<doc>Creates and returns a dictionary based on the given ``items``.</doc>
<msg timestamp="20220722 15:42:44.502" level="INFO">${Test_Data} = {}</msg>
<status status="PASS" starttime="20220722 15:42:44.502" endtime="20220722 15:42:44.502"/>
</kw>
<kw name="Get Length" library="BuiltIn">
<var>${length}</var>
<arg>${DATA}</arg>
<doc>Returns and logs the length of the given item as an integer.</doc>
<msg timestamp="20220722 15:42:44.502" level="INFO">Length is 6</msg>
<msg timestamp="20220722 15:42:44.502" level="INFO">${length} = 6</msg>
<status status="PASS" starttime="20220722 15:42:44.502" endtime="20220722 15:42:44.502"/>
</kw>
<for flavor="IN RANGE">
<var>${i}</var>
<value>0</value>
<value>${length}</value>
<iter>
<var name="${i}">0</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:44.503" endtime="20220722 15:42:44.504"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.503" endtime="20220722 15:42:44.504"/>
</iter>
<iter>
<var name="${i}">1</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:44.505" endtime="20220722 15:42:44.507"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.505" endtime="20220722 15:42:44.507"/>
</iter>
<iter>
<var name="${i}">2</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:44.507" endtime="20220722 15:42:44.508"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.507" endtime="20220722 15:42:44.508"/>
</iter>
<iter>
<var name="${i}">3</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:44.509" endtime="20220722 15:42:44.510"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.508" endtime="20220722 15:42:44.510"/>
</iter>
<iter>
<var name="${i}">4</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:44.510" endtime="20220722 15:42:44.511"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.510" endtime="20220722 15:42:44.511"/>
</iter>
<iter>
<var name="${i}">5</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:44.512" endtime="20220722 15:42:44.513"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.512" endtime="20220722 15:42:44.513"/>
</iter>
<status status="PASS" starttime="20220722 15:42:44.502" endtime="20220722 15:42:44.513"/>
</for>
<kw name="Log Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<doc>Logs the size and contents of the ``dictionary`` using given ``level``.</doc>
<msg timestamp="20220722 15:42:44.513" level="INFO">Dictionary size is 6 and it contains following items:
 TestResult: PASSED
ExpectedApi: 401
ExpectedRespone: None
Test Description: Validate   การแสดงข้อมูลสถานะ โดย Empty value Parameter Header 
- Authorization  
TestCaseNumber: HR1005_500
actualRespone: Unauthorized</msg>
<status status="PASS" starttime="20220722 15:42:44.513" endtime="20220722 15:42:44.513"/>
</kw>
<msg timestamp="20220722 15:42:44.513" level="INFO">${data_test} = {' TestResult': 'PASSED', 'ExpectedApi': 401, 'ExpectedRespone': None, 'actualRespone': 'Unauthorized', 'TestCaseNumber': 'HR1005_500', 'Test Description': 'Validate   การแสดงข้อมูลสถานะ โดย Empty val...</msg>
<status status="PASS" starttime="20220722 15:42:44.413" endtime="20220722 15:42:44.513"/>
</kw>
<kw name="Prepare_Data_For_API_HealthCheck_Readiness" library="PrepareDataKeyword">
<var>${request}</var>
<arg>${data_test}</arg>
<kw name="Get Binary File" library="OperatingSystem">
<var>${json_string}</var>
<arg>${file_path_request}.json</arg>
<doc>Returns the contents of a specified file.</doc>
<msg timestamp="20220722 15:42:44.514" level="INFO" html="true">Getting file '&lt;a href="file://C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource\DataTest\API_CollectionPoint\CollectionPointList.json"&gt;C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource\DataTest\API_CollectionPoint\CollectionPointList.json&lt;/a&gt;'.</msg>
<msg timestamp="20220722 15:42:44.514" level="INFO">${json_string} = {}</msg>
<status status="PASS" starttime="20220722 15:42:44.514" endtime="20220722 15:42:44.514"/>
</kw>
<kw name="Log" library="BuiltIn">
<arg>${json_string}</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20220722 15:42:44.514" level="INFO">{}</msg>
<status status="PASS" starttime="20220722 15:42:44.514" endtime="20220722 15:42:44.514"/>
</kw>
<kw name="Evaluate" library="BuiltIn">
<var>${json}</var>
<arg>json.loads('''${json_string}''')</arg>
<arg>json</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<msg timestamp="20220722 15:42:44.515" level="INFO">${json} = {}</msg>
<status status="PASS" starttime="20220722 15:42:44.514" endtime="20220722 15:42:44.515"/>
</kw>
<kw name="Log Dictionary" library="Collections">
<arg>${json}</arg>
<doc>Logs the size and contents of the ``dictionary`` using given ``level``.</doc>
<msg timestamp="20220722 15:42:44.515" level="INFO">Dictionary is empty.</msg>
<status status="PASS" starttime="20220722 15:42:44.515" endtime="20220722 15:42:44.515"/>
</kw>
<kw name="Evaluate" library="BuiltIn">
<var>${json_string}</var>
<arg>json.dumps(${json})</arg>
<arg>json</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<msg timestamp="20220722 15:42:44.515" level="INFO">${json_string} = {}</msg>
<status status="PASS" starttime="20220722 15:42:44.515" endtime="20220722 15:42:44.515"/>
</kw>
<kw name="Log Many" library="BuiltIn">
<arg>${json_string}</arg>
<doc>Logs the given messages as separate entries using the INFO level.</doc>
<msg timestamp="20220722 15:42:44.515" level="INFO">{}</msg>
<status status="PASS" starttime="20220722 15:42:44.515" endtime="20220722 15:42:44.515"/>
</kw>
<kw name="Log" library="BuiltIn">
<arg>${json_string}</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20220722 15:42:44.515" level="INFO">{}</msg>
<status status="PASS" starttime="20220722 15:42:44.515" endtime="20220722 15:42:44.515"/>
</kw>
<msg timestamp="20220722 15:42:44.516" level="INFO">${request} = {}</msg>
<status status="PASS" starttime="20220722 15:42:44.513" endtime="20220722 15:42:44.516"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<var>${data}</var>
<arg>${rowNo} == 2</arg>
<arg>Validation_API_HealthCheck_Readiness</arg>
<arg>${request}</arg>
<arg>${statusCode}</arg>
<arg>${rowNo}</arg>
<arg>ELSE</arg>
<arg>Validation_API_HealthCheck_Readiness_Fail</arg>
<arg>${request}</arg>
<arg>${statusCode}</arg>
<arg>${rowNo}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="Validation_API_HealthCheck_Readiness_Fail" library="API_HealthCheck">
<arg>${request}</arg>
<arg>${statusCode}</arg>
<arg>${rowNo}</arg>
<kw name="Create Session" library="RequestsLibrary">
<arg>HealthCheck_Readiness</arg>
<arg>${HOST_NAME}</arg>
<arg>verify=${True}</arg>
<doc>Create Session: create a HTTP session to a server</doc>
<msg timestamp="20220722 15:42:44.517" level="INFO">Creating Session using : alias=HealthCheck_Readiness, url=https://viriyah-pdpa-api.azurewebsites.net, headers={},                     cookies={}, auth=None, timeout=None, proxies=None, verify=True,                     debug=0 </msg>
<status status="PASS" starttime="20220722 15:42:44.516" endtime="20220722 15:42:44.517"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<var>${HEADER_HEALTHCHECK_READINESS}</var>
<arg>${rowNo} == 4</arg>
<arg>create dictionary</arg>
<arg>Content-Type=application/json</arg>
<arg>Accept=application/json</arg>
<arg>ELSE IF</arg>
<arg>${rowNo} == 5</arg>
<arg>create dictionary</arg>
<arg>Authorization=${empty}</arg>
<arg>Content-Type=application/json</arg>
<arg>Accept=application/json</arg>
<arg>ELSE IF</arg>
<arg>${rowNo} == 6</arg>
<arg>create dictionary</arg>
<arg>Authorization=${INVALID}</arg>
<arg>Content-Type=application/json</arg>
<arg>Accept=application/json</arg>
<arg>ELSE</arg>
<arg>create dictionary</arg>
<arg>Authorization=${token}</arg>
<arg>Content-Type=application/json</arg>
<arg>Accept=application/json</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="Create Dictionary" library="BuiltIn">
<arg>Authorization=${empty}</arg>
<arg>Content-Type=application/json</arg>
<arg>Accept=application/json</arg>
<doc>Creates and returns a dictionary based on the given ``items``.</doc>
<status status="PASS" starttime="20220722 15:42:44.517" endtime="20220722 15:42:44.518"/>
</kw>
<msg timestamp="20220722 15:42:44.518" level="INFO">${HEADER_HEALTHCHECK_READINESS} = {'Authorization': '', 'Content-Type': 'application/json', 'Accept': 'application/json'}</msg>
<status status="PASS" starttime="20220722 15:42:44.517" endtime="20220722 15:42:44.518"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<var>${response}</var>
<arg>${rowNo} == 3</arg>
<arg>GET On Session</arg>
<arg>HealthCheck_Readiness</arg>
<arg>${API_HEALTHCHECK_READINESS_ERROR['${ENV}']}</arg>
<arg>data=${request}</arg>
<arg>headers=${HEADER_HEALTHCHECK_READINESS}</arg>
<arg>expected_status=${statusCode}</arg>
<arg>ELSE</arg>
<arg>GET On Session</arg>
<arg>HealthCheck_Readiness</arg>
<arg>${API_HEALTHCHECK_READINESS['${ENV}']}</arg>
<arg>data=${request}</arg>
<arg>headers=${HEADER_HEALTHCHECK_READINESS}</arg>
<arg>expected_status=${statusCode}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="GET On Session" library="RequestsLibrary">
<arg>HealthCheck_Readiness</arg>
<arg>${API_HEALTHCHECK_READINESS['${ENV}']}</arg>
<arg>data=${request}</arg>
<arg>headers=${HEADER_HEALTHCHECK_READINESS}</arg>
<arg>expected_status=${statusCode}</arg>
<doc>Sends a GET request on a previously created HTTP Session.</doc>
<msg timestamp="20220722 15:42:44.680" level="INFO">GET Request : url=https://viriyah-pdpa-api.azurewebsites.net/api/health/readiness 
 path_url=/api/health/readiness 
 headers={'User-Agent': 'python-requests/2.28.0', 'Accept-Encoding': 'gzip, deflate', 'Accept': 'application/json', 'Connection': 'keep-alive', 'Authorization': '', 'Content-Type': 'application/json', 'Content-Length': '2'} 
 body={} 
 </msg>
<msg timestamp="20220722 15:42:44.680" level="INFO">GET Response : url=https://viriyah-pdpa-api.azurewebsites.net/api/health/readiness 
 status=401, reason=Unauthorized 
 headers={'Content-Length': '12', 'Content-Type': 'text/plain; charset=utf-8', 'Date': 'Fri, 22 Jul 2022 08:42:44 GMT', 'Server': 'Microsoft-IIS/10.0', 'Cache-Control': 'no-cache', 'Expires': '-1', 'Pragma': 'no-cache', 'Set-Cookie': 'ARRAffinity=b4313bdd91804439d7049c28e075e5fe38cdf75951b4356e26b1e09bca34d54c;Path=/;HttpOnly;Secure;Domain=viriyah-pdpa-api.azurewebsites.net, ARRAffinitySameSite=b4313bdd91804439d7049c28e075e5fe38cdf75951b4356e26b1e09bca34d54c;Path=/;HttpOnly;SameSite=None;Secure;Domain=viriyah-pdpa-api.azurewebsites.net', 'X-AspNet-Version': '4.0.30319', 'X-Powered-By': 'ASP.NET'} 
 body=Unauthorized 
 </msg>
<status status="PASS" starttime="20220722 15:42:44.518" endtime="20220722 15:42:44.680"/>
</kw>
<msg timestamp="20220722 15:42:44.681" level="INFO">${response} = &lt;Response [401]&gt;</msg>
<status status="PASS" starttime="20220722 15:42:44.518" endtime="20220722 15:42:44.681"/>
</kw>
<kw name="Log Many" library="BuiltIn">
<arg>${response.text}</arg>
<doc>Logs the given messages as separate entries using the INFO level.</doc>
<msg timestamp="20220722 15:42:44.682" level="INFO">Unauthorized</msg>
<status status="PASS" starttime="20220722 15:42:44.681" endtime="20220722 15:42:44.682"/>
</kw>
<kw name="Should Be Equal As Strings" library="BuiltIn">
<arg>${statusCode}</arg>
<arg>${response.status_code}</arg>
<doc>Fails if objects are unequal after converting them to strings.</doc>
<msg timestamp="20220722 15:42:44.683" level="INFO">Argument types are:
&lt;class 'str'&gt;
&lt;class 'int'&gt;</msg>
<status status="PASS" starttime="20220722 15:42:44.683" endtime="20220722 15:42:44.683"/>
</kw>
<kw name="Set Test Variable" library="BuiltIn">
<arg>${actual}</arg>
<arg>${response.text}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<msg timestamp="20220722 15:42:44.685" level="INFO">${actual} = Unauthorized</msg>
<status status="PASS" starttime="20220722 15:42:44.684" endtime="20220722 15:42:44.685"/>
</kw>
<kw name="Run Keyword And Return Status" library="BuiltIn">
<var>${status}</var>
<arg>Should Be Equal As Strings</arg>
<arg>${statusCode}</arg>
<arg>${response.status_code}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<kw name="Should Be Equal As Strings" library="BuiltIn">
<arg>${statusCode}</arg>
<arg>${response.status_code}</arg>
<doc>Fails if objects are unequal after converting them to strings.</doc>
<msg timestamp="20220722 15:42:44.686" level="INFO">Argument types are:
&lt;class 'str'&gt;
&lt;class 'int'&gt;</msg>
<status status="PASS" starttime="20220722 15:42:44.685" endtime="20220722 15:42:44.686"/>
</kw>
<msg timestamp="20220722 15:42:44.686" level="INFO">${status} = True</msg>
<status status="PASS" starttime="20220722 15:42:44.685" endtime="20220722 15:42:44.686"/>
</kw>
<kw name="Write_Result_Status_To_Excel_HealthCheck" library="ExcelKeyword">
<arg>${EXCEL_NAME}</arg>
<arg>${SHEET_NAME}</arg>
<arg>${rowNo}</arg>
<arg>${status}</arg>
<kw name="Open Excel Document" library="ExcelLibraryV2">
<arg>${fileExcel}</arg>
<arg>Test</arg>
<doc>Opens xlsx document file.</doc>
<status status="PASS" starttime="20220722 15:42:44.686" endtime="20220722 15:42:44.708"/>
</kw>
<kw name="Log" library="BuiltIn">
<arg>${status}</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20220722 15:42:44.709" level="INFO">True</msg>
<status status="PASS" starttime="20220722 15:42:44.708" endtime="20220722 15:42:44.709"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>${status}==True</arg>
<arg>Write Excel Cell</arg>
<arg>row_num=${rowNo}</arg>
<arg>col_num=1</arg>
<arg>value=PASSED</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="Write Excel Cell" library="ExcelLibraryV2">
<arg>row_num=${rowNo}</arg>
<arg>col_num=1</arg>
<arg>value=PASSED</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Writes value to the cell.</doc>
<status status="PASS" starttime="20220722 15:42:44.709" endtime="20220722 15:42:44.709"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.709" endtime="20220722 15:42:44.709"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>${status}==False</arg>
<arg>Write Excel Cell</arg>
<arg>row_num=${rowNo}</arg>
<arg>col_num=1</arg>
<arg>value=FAILED</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" starttime="20220722 15:42:44.709" endtime="20220722 15:42:44.709"/>
</kw>
<kw name="Write Excel Cell" library="ExcelLibraryV2">
<arg>row_num=${rowNo}</arg>
<arg>col_num=4</arg>
<arg>value=${actual}</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Writes value to the cell.</doc>
<status status="PASS" starttime="20220722 15:42:44.710" endtime="20220722 15:42:44.710"/>
</kw>
<kw name="Save Excel Document" library="ExcelLibraryV2">
<arg>${fileExcel}</arg>
<doc>Saves the current document to disk.</doc>
<status status="PASS" starttime="20220722 15:42:44.710" endtime="20220722 15:42:44.752"/>
</kw>
<kw name="Close All Excel Documents" library="ExcelLibraryV2">
<doc>Closes all opened documents.</doc>
<status status="PASS" starttime="20220722 15:42:44.752" endtime="20220722 15:42:44.752"/>
</kw>
<kw name="Close All Excel Documents" library="ExcelLibraryV2" type="TEARDOWN">
<doc>Closes all opened documents.</doc>
<status status="PASS" starttime="20220722 15:42:44.753" endtime="20220722 15:42:44.753"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.686" endtime="20220722 15:42:44.753"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>${status}==False</arg>
<arg>Log</arg>
<arg>Fail</arg>
<arg>ELSE IF</arg>
<arg>${status}==True</arg>
<arg>Log</arg>
<arg>${actual}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="Log" library="BuiltIn">
<arg>${actual}</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20220722 15:42:44.753" level="INFO">Unauthorized</msg>
<status status="PASS" starttime="20220722 15:42:44.753" endtime="20220722 15:42:44.753"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.753" endtime="20220722 15:42:44.753"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.516" endtime="20220722 15:42:44.753"/>
</kw>
<msg timestamp="20220722 15:42:44.753" level="INFO">${data} = None</msg>
<status status="PASS" starttime="20220722 15:42:44.516" endtime="20220722 15:42:44.753"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.410" endtime="20220722 15:42:44.753"/>
</kw>
<kw name="Close Browser" library="Selenium2Library" type="TEARDOWN">
<doc>Closes the current browser.</doc>
<status status="PASS" starttime="20220722 15:42:44.754" endtime="20220722 15:42:44.754"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.402" endtime="20220722 15:42:44.754"/>
</test>
<test id="s1-t5" name="HealthCheck Readiness Invalid" line="37">
<kw name="Run Keywords" library="BuiltIn" type="SETUP">
<arg>Set Test Variable</arg>
<arg>${EXCEL_NAME}</arg>
<arg>${EXCEL_2C2P_PAYMENT}</arg>
<arg>AND</arg>
<arg>Set Test Variable</arg>
<arg>${SHEET_NAME}</arg>
<arg>${SHEET_HealthCheckReadiness}</arg>
<doc>Executes all the given keywords in a sequence.</doc>
<kw name="Set Test Variable" library="BuiltIn">
<arg>${EXCEL_NAME}</arg>
<arg>${EXCEL_2C2P_PAYMENT}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<msg timestamp="20220722 15:42:44.756" level="INFO">${EXCEL_NAME} = ./TestResource/DataTest/Excel_Script/PDPA_Script.xlsx</msg>
<status status="PASS" starttime="20220722 15:42:44.755" endtime="20220722 15:42:44.756"/>
</kw>
<kw name="Set Test Variable" library="BuiltIn">
<arg>${SHEET_NAME}</arg>
<arg>${SHEET_HealthCheckReadiness}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<msg timestamp="20220722 15:42:44.757" level="INFO">${SHEET_NAME} = HealthCheckReadiness</msg>
<status status="PASS" starttime="20220722 15:42:44.756" endtime="20220722 15:42:44.757"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.755" endtime="20220722 15:42:44.757"/>
</kw>
<kw name="API_HealthCheck_Readiness" library="API_HealthCheck">
<arg>6</arg>
<arg>500</arg>
<arg>HL1006_600</arg>
<kw name="Generate_File_Path_Request" library="PDPA_Keyword">
<arg>${JSON_CollectionPoint}</arg>
<doc>- สร้าง path สำหรับไฟล์ request เพื่อให้ใช้ได้ทุกๆเครื่อง</doc>
<kw name="Remove String" library="String">
<var>${NEWDIR}</var>
<arg>C:\\Users\\niranl\\OneDrive - The viriyah Insurance\\Desktop\\PDPA\\TestResource\\Keywords\\API_Keyword</arg>
<arg>${/}Keywords${/}API_Keyword</arg>
<doc>Removes all ``removables`` from the given ``string``.</doc>
<msg timestamp="20220722 15:42:44.758" level="INFO">${NEWDIR} = C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource</msg>
<status status="PASS" starttime="20220722 15:42:44.758" endtime="20220722 15:42:44.758"/>
</kw>
<kw name="Catenate" library="BuiltIn">
<var>${file_path_request}</var>
<arg>SEPARATOR=${/}</arg>
<arg>${NEWDIR}${/}DataTest${/}${path_request}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<msg timestamp="20220722 15:42:44.758" level="INFO">${file_path_request} = C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource\DataTest\./API_CollectionPoint/CollectionPointList</msg>
<status status="PASS" starttime="20220722 15:42:44.758" endtime="20220722 15:42:44.758"/>
</kw>
<kw name="Set Suite Variable" library="BuiltIn">
<arg>${path_request}</arg>
<doc>Makes a variable available everywhere within the scope of the current suite.</doc>
<msg timestamp="20220722 15:42:44.759" level="INFO">${path_request} = ./API_CollectionPoint/CollectionPointList</msg>
<status status="PASS" starttime="20220722 15:42:44.758" endtime="20220722 15:42:44.759"/>
</kw>
<kw name="Set Suite Variable" library="BuiltIn">
<arg>${file_path_request}</arg>
<doc>Makes a variable available everywhere within the scope of the current suite.</doc>
<msg timestamp="20220722 15:42:44.759" level="INFO">${file_path_request} = C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource\DataTest\./API_CollectionPoint/CollectionPointList</msg>
<status status="PASS" starttime="20220722 15:42:44.759" endtime="20220722 15:42:44.759"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.757" endtime="20220722 15:42:44.759"/>
</kw>
<kw name="Read_Excel_For_Test" library="ExcelKeyword">
<var>${data_test}</var>
<arg>${EXCEL_NAME}</arg>
<arg>${SHEET_NAME}</arg>
<arg>${rowNo}</arg>
<kw name="Open Excel Document" library="ExcelLibraryV2">
<arg>${fileExcel}</arg>
<arg>Test</arg>
<arg>True</arg>
<doc>Opens xlsx document file.</doc>
<status status="PASS" starttime="20220722 15:42:44.760" endtime="20220722 15:42:44.800"/>
</kw>
<kw name="Get List Sheet Names" library="ExcelLibraryV2">
<var>${sheets}</var>
<doc>Returns a list of sheet names in the current document.</doc>
<msg timestamp="20220722 15:42:44.800" level="INFO">${sheets} = ['CollectionPointList', 'CollectionPointInfo', 'GeneralConsentList', 'GeneralConsentSubmit', 'HealthCheckLiveness', 'HealthCheckReadiness']</msg>
<status status="PASS" starttime="20220722 15:42:44.800" endtime="20220722 15:42:44.800"/>
</kw>
<kw name="List Should Contain Value" library="Collections">
<arg>${sheets}</arg>
<arg>${sheetName}</arg>
<doc>Fails if the ``value`` is not found from ``list``.</doc>
<status status="PASS" starttime="20220722 15:42:44.800" endtime="20220722 15:42:44.800"/>
</kw>
<kw name="Read Excel Row" library="ExcelLibraryV2">
<var>@{HEAD}</var>
<arg>row_num=1</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Returns content of a row from the current sheet of the document.</doc>
<msg timestamp="20220722 15:42:44.801" level="INFO">@{HEAD} = [  TestResult | ExpectedApi | ExpectedRespone | actualRespone | TestCaseNumber | Test Description ]</msg>
<status status="PASS" starttime="20220722 15:42:44.800" endtime="20220722 15:42:44.801"/>
</kw>
<kw name="Read Excel Row" library="ExcelLibraryV2">
<var>@{DATA}</var>
<arg>row_num=${rowNo}</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Returns content of a row from the current sheet of the document.</doc>
<msg timestamp="20220722 15:42:44.801" level="INFO">@{DATA} = [ None | 500 | None | None | HL1006_600 | Validate  การแสดงข้อมูลสถานะ โดย Parameter Invalid Header_x000D_
- Authorization _x000D_
(wrong format) ]</msg>
<status status="PASS" starttime="20220722 15:42:44.801" endtime="20220722 15:42:44.801"/>
</kw>
<kw name="Log List" library="Collections">
<arg>${HEAD}</arg>
<doc>Logs the length and contents of the ``list`` using given ``level``.</doc>
<msg timestamp="20220722 15:42:44.801" level="INFO">List length is 6 and it contains following items:
0:  TestResult
1: ExpectedApi
2: ExpectedRespone
3: actualRespone
4: TestCaseNumber
5: Test Description</msg>
<status status="PASS" starttime="20220722 15:42:44.801" endtime="20220722 15:42:44.801"/>
</kw>
<kw name="Log List" library="Collections">
<arg>${DATA}</arg>
<doc>Logs the length and contents of the ``list`` using given ``level``.</doc>
<msg timestamp="20220722 15:42:44.801" level="INFO">List length is 6 and it contains following items:
0: None
1: 500
2: None
3: None
4: HL1006_600
5: Validate  การแสดงข้อมูลสถานะ โดย Parameter Invalid Header_x000D_
- Authorization _x000D_
(wrong format)</msg>
<status status="PASS" starttime="20220722 15:42:44.801" endtime="20220722 15:42:44.801"/>
</kw>
<kw name="Close All Excel Documents" library="ExcelLibraryV2">
<doc>Closes all opened documents.</doc>
<status status="PASS" starttime="20220722 15:42:44.801" endtime="20220722 15:42:44.802"/>
</kw>
<kw name="Create Dictionary" library="BuiltIn">
<var>${Test_Data}</var>
<doc>Creates and returns a dictionary based on the given ``items``.</doc>
<msg timestamp="20220722 15:42:44.802" level="INFO">${Test_Data} = {}</msg>
<status status="PASS" starttime="20220722 15:42:44.802" endtime="20220722 15:42:44.802"/>
</kw>
<kw name="Get Length" library="BuiltIn">
<var>${length}</var>
<arg>${DATA}</arg>
<doc>Returns and logs the length of the given item as an integer.</doc>
<msg timestamp="20220722 15:42:44.802" level="INFO">Length is 6</msg>
<msg timestamp="20220722 15:42:44.802" level="INFO">${length} = 6</msg>
<status status="PASS" starttime="20220722 15:42:44.802" endtime="20220722 15:42:44.802"/>
</kw>
<for flavor="IN RANGE">
<var>${i}</var>
<value>0</value>
<value>${length}</value>
<iter>
<var name="${i}">0</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:44.802" endtime="20220722 15:42:44.803"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.802" endtime="20220722 15:42:44.803"/>
</iter>
<iter>
<var name="${i}">1</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:44.804" endtime="20220722 15:42:44.805"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.803" endtime="20220722 15:42:44.805"/>
</iter>
<iter>
<var name="${i}">2</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:44.806" endtime="20220722 15:42:44.807"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.805" endtime="20220722 15:42:44.808"/>
</iter>
<iter>
<var name="${i}">3</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:44.808" endtime="20220722 15:42:44.810"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.808" endtime="20220722 15:42:44.810"/>
</iter>
<iter>
<var name="${i}">4</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:44.811" endtime="20220722 15:42:44.813"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.810" endtime="20220722 15:42:44.813"/>
</iter>
<iter>
<var name="${i}">5</var>
<kw name="Set To Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<arg>${HEAD[${i}]}=${DATA[${i}]}</arg>
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<status status="PASS" starttime="20220722 15:42:44.813" endtime="20220722 15:42:44.815"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.813" endtime="20220722 15:42:44.815"/>
</iter>
<status status="PASS" starttime="20220722 15:42:44.802" endtime="20220722 15:42:44.815"/>
</for>
<kw name="Log Dictionary" library="Collections">
<arg>${Test_Data}</arg>
<doc>Logs the size and contents of the ``dictionary`` using given ``level``.</doc>
<msg timestamp="20220722 15:42:44.816" level="INFO">Dictionary size is 6 and it contains following items:
 TestResult: None
ExpectedApi: 500
ExpectedRespone: None
Test Description: Validate  การแสดงข้อมูลสถานะ โดย Parameter Invalid Header_x000D_
- Authorization _x000D_
(wrong format)
TestCaseNumber: HL1006_600
actualRespone: None</msg>
<status status="PASS" starttime="20220722 15:42:44.815" endtime="20220722 15:42:44.816"/>
</kw>
<msg timestamp="20220722 15:42:44.816" level="INFO">${data_test} = {' TestResult': None, 'ExpectedApi': 500, 'ExpectedRespone': None, 'actualRespone': None, 'TestCaseNumber': 'HL1006_600', 'Test Description': 'Validate  การแสดงข้อมูลสถานะ โดย Parameter Invalid Header...</msg>
<status status="PASS" starttime="20220722 15:42:44.759" endtime="20220722 15:42:44.816"/>
</kw>
<kw name="Prepare_Data_For_API_HealthCheck_Readiness" library="PrepareDataKeyword">
<var>${request}</var>
<arg>${data_test}</arg>
<kw name="Get Binary File" library="OperatingSystem">
<var>${json_string}</var>
<arg>${file_path_request}.json</arg>
<doc>Returns the contents of a specified file.</doc>
<msg timestamp="20220722 15:42:44.817" level="INFO" html="true">Getting file '&lt;a href="file://C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource\DataTest\API_CollectionPoint\CollectionPointList.json"&gt;C:\Users\niranl\OneDrive - The viriyah Insurance\Desktop\PDPA\TestResource\DataTest\API_CollectionPoint\CollectionPointList.json&lt;/a&gt;'.</msg>
<msg timestamp="20220722 15:42:44.817" level="INFO">${json_string} = {}</msg>
<status status="PASS" starttime="20220722 15:42:44.816" endtime="20220722 15:42:44.817"/>
</kw>
<kw name="Log" library="BuiltIn">
<arg>${json_string}</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20220722 15:42:44.817" level="INFO">{}</msg>
<status status="PASS" starttime="20220722 15:42:44.817" endtime="20220722 15:42:44.817"/>
</kw>
<kw name="Evaluate" library="BuiltIn">
<var>${json}</var>
<arg>json.loads('''${json_string}''')</arg>
<arg>json</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<msg timestamp="20220722 15:42:44.818" level="INFO">${json} = {}</msg>
<status status="PASS" starttime="20220722 15:42:44.818" endtime="20220722 15:42:44.818"/>
</kw>
<kw name="Log Dictionary" library="Collections">
<arg>${json}</arg>
<doc>Logs the size and contents of the ``dictionary`` using given ``level``.</doc>
<msg timestamp="20220722 15:42:44.818" level="INFO">Dictionary is empty.</msg>
<status status="PASS" starttime="20220722 15:42:44.818" endtime="20220722 15:42:44.818"/>
</kw>
<kw name="Evaluate" library="BuiltIn">
<var>${json_string}</var>
<arg>json.dumps(${json})</arg>
<arg>json</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<msg timestamp="20220722 15:42:44.819" level="INFO">${json_string} = {}</msg>
<status status="PASS" starttime="20220722 15:42:44.818" endtime="20220722 15:42:44.819"/>
</kw>
<kw name="Log Many" library="BuiltIn">
<arg>${json_string}</arg>
<doc>Logs the given messages as separate entries using the INFO level.</doc>
<msg timestamp="20220722 15:42:44.819" level="INFO">{}</msg>
<status status="PASS" starttime="20220722 15:42:44.819" endtime="20220722 15:42:44.819"/>
</kw>
<kw name="Log" library="BuiltIn">
<arg>${json_string}</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20220722 15:42:44.820" level="INFO">{}</msg>
<status status="PASS" starttime="20220722 15:42:44.820" endtime="20220722 15:42:44.820"/>
</kw>
<msg timestamp="20220722 15:42:44.820" level="INFO">${request} = {}</msg>
<status status="PASS" starttime="20220722 15:42:44.816" endtime="20220722 15:42:44.820"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<var>${data}</var>
<arg>${rowNo} == 2</arg>
<arg>Validation_API_HealthCheck_Readiness</arg>
<arg>${request}</arg>
<arg>${statusCode}</arg>
<arg>${rowNo}</arg>
<arg>ELSE</arg>
<arg>Validation_API_HealthCheck_Readiness_Fail</arg>
<arg>${request}</arg>
<arg>${statusCode}</arg>
<arg>${rowNo}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="Validation_API_HealthCheck_Readiness_Fail" library="API_HealthCheck">
<arg>${request}</arg>
<arg>${statusCode}</arg>
<arg>${rowNo}</arg>
<kw name="Create Session" library="RequestsLibrary">
<arg>HealthCheck_Readiness</arg>
<arg>${HOST_NAME}</arg>
<arg>verify=${True}</arg>
<doc>Create Session: create a HTTP session to a server</doc>
<msg timestamp="20220722 15:42:44.822" level="INFO">Creating Session using : alias=HealthCheck_Readiness, url=https://viriyah-pdpa-api.azurewebsites.net, headers={},                     cookies={}, auth=None, timeout=None, proxies=None, verify=True,                     debug=0 </msg>
<status status="PASS" starttime="20220722 15:42:44.822" endtime="20220722 15:42:44.824"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<var>${HEADER_HEALTHCHECK_READINESS}</var>
<arg>${rowNo} == 4</arg>
<arg>create dictionary</arg>
<arg>Content-Type=application/json</arg>
<arg>Accept=application/json</arg>
<arg>ELSE IF</arg>
<arg>${rowNo} == 5</arg>
<arg>create dictionary</arg>
<arg>Authorization=${empty}</arg>
<arg>Content-Type=application/json</arg>
<arg>Accept=application/json</arg>
<arg>ELSE IF</arg>
<arg>${rowNo} == 6</arg>
<arg>create dictionary</arg>
<arg>Authorization=${INVALID}</arg>
<arg>Content-Type=application/json</arg>
<arg>Accept=application/json</arg>
<arg>ELSE</arg>
<arg>create dictionary</arg>
<arg>Authorization=${token}</arg>
<arg>Content-Type=application/json</arg>
<arg>Accept=application/json</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="Create Dictionary" library="BuiltIn">
<arg>Authorization=${INVALID}</arg>
<arg>Content-Type=application/json</arg>
<arg>Accept=application/json</arg>
<doc>Creates and returns a dictionary based on the given ``items``.</doc>
<status status="PASS" starttime="20220722 15:42:44.824" endtime="20220722 15:42:44.825"/>
</kw>
<msg timestamp="20220722 15:42:44.825" level="INFO">${HEADER_HEALTHCHECK_READINESS} = {'Authorization': 'Invalid', 'Content-Type': 'application/json', 'Accept': 'application/json'}</msg>
<status status="PASS" starttime="20220722 15:42:44.824" endtime="20220722 15:42:44.825"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<var>${response}</var>
<arg>${rowNo} == 3</arg>
<arg>GET On Session</arg>
<arg>HealthCheck_Readiness</arg>
<arg>${API_HEALTHCHECK_READINESS_ERROR['${ENV}']}</arg>
<arg>data=${request}</arg>
<arg>headers=${HEADER_HEALTHCHECK_READINESS}</arg>
<arg>expected_status=${statusCode}</arg>
<arg>ELSE</arg>
<arg>GET On Session</arg>
<arg>HealthCheck_Readiness</arg>
<arg>${API_HEALTHCHECK_READINESS['${ENV}']}</arg>
<arg>data=${request}</arg>
<arg>headers=${HEADER_HEALTHCHECK_READINESS}</arg>
<arg>expected_status=${statusCode}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="GET On Session" library="RequestsLibrary">
<arg>HealthCheck_Readiness</arg>
<arg>${API_HEALTHCHECK_READINESS['${ENV}']}</arg>
<arg>data=${request}</arg>
<arg>headers=${HEADER_HEALTHCHECK_READINESS}</arg>
<arg>expected_status=${statusCode}</arg>
<doc>Sends a GET request on a previously created HTTP Session.</doc>
<msg timestamp="20220722 15:42:45.001" level="INFO">GET Request : url=https://viriyah-pdpa-api.azurewebsites.net/api/health/readiness 
 path_url=/api/health/readiness 
 headers={'User-Agent': 'python-requests/2.28.0', 'Accept-Encoding': 'gzip, deflate', 'Accept': 'application/json', 'Connection': 'keep-alive', 'Authorization': 'Invalid', 'Content-Type': 'application/json', 'Content-Length': '2'} 
 body={} 
 </msg>
<msg timestamp="20220722 15:42:45.001" level="INFO">GET Response : url=https://viriyah-pdpa-api.azurewebsites.net/api/health/readiness 
 status=500, reason=Internal Server Error 
 headers={'Content-Length': '1441', 'Content-Type': 'application/json; charset=utf-8', 'Date': 'Fri, 22 Jul 2022 08:42:44 GMT', 'Server': 'Microsoft-IIS/10.0', 'Cache-Control': 'no-cache', 'Expires': '-1', 'Pragma': 'no-cache', 'Set-Cookie': 'ARRAffinity=b4313bdd91804439d7049c28e075e5fe38cdf75951b4356e26b1e09bca34d54c;Path=/;HttpOnly;Secure;Domain=viriyah-pdpa-api.azurewebsites.net, ARRAffinitySameSite=b4313bdd91804439d7049c28e075e5fe38cdf75951b4356e26b1e09bca34d54c;Path=/;HttpOnly;SameSite=None;Secure;Domain=viriyah-pdpa-api.azurewebsites.net', 'X-AspNet-Version': '4.0.30319', 'X-Powered-By': 'ASP.NET'} 
 body={"Message":"An error has occurred.","ExceptionMessage":"Token invalid","ExceptionType":"System.Exception","StackTrace":"   at SEMS.API.AuthorizationFilterAttribute.OnActionExecuting(HttpActionContext actionContext)\r\n   at System.Web.Http.Filters.ActionFilterAttribute.OnActionExecutingAsync(HttpActionContext actionContext, CancellationToken cancellationToken)\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Web.Http.Filters.ActionFilterAttribute.&lt;ExecuteActionFilterAsyncCore&gt;d__5.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Web.Http.Controllers.ActionFilterResult.&lt;ExecuteAsync&gt;d__5.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Web.Http.Dispatcher.HttpControllerDispatcher.&lt;SendAsync&gt;d__15.MoveNext()"} 
 </msg>
<status status="PASS" starttime="20220722 15:42:44.825" endtime="20220722 15:42:45.001"/>
</kw>
<msg timestamp="20220722 15:42:45.002" level="INFO">${response} = &lt;Response [500]&gt;</msg>
<status status="PASS" starttime="20220722 15:42:44.825" endtime="20220722 15:42:45.002"/>
</kw>
<kw name="Log Many" library="BuiltIn">
<arg>${response.text}</arg>
<doc>Logs the given messages as separate entries using the INFO level.</doc>
<msg timestamp="20220722 15:42:45.002" level="INFO">{"Message":"An error has occurred.","ExceptionMessage":"Token invalid","ExceptionType":"System.Exception","StackTrace":"   at SEMS.API.AuthorizationFilterAttribute.OnActionExecuting(HttpActionContext actionContext)\r\n   at System.Web.Http.Filters.ActionFilterAttribute.OnActionExecutingAsync(HttpActionContext actionContext, CancellationToken cancellationToken)\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Web.Http.Filters.ActionFilterAttribute.&lt;ExecuteActionFilterAsyncCore&gt;d__5.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Web.Http.Controllers.ActionFilterResult.&lt;ExecuteAsync&gt;d__5.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Web.Http.Dispatcher.HttpControllerDispatcher.&lt;SendAsync&gt;d__15.MoveNext()"}</msg>
<status status="PASS" starttime="20220722 15:42:45.002" endtime="20220722 15:42:45.002"/>
</kw>
<kw name="Should Be Equal As Strings" library="BuiltIn">
<arg>${statusCode}</arg>
<arg>${response.status_code}</arg>
<doc>Fails if objects are unequal after converting them to strings.</doc>
<msg timestamp="20220722 15:42:45.003" level="INFO">Argument types are:
&lt;class 'str'&gt;
&lt;class 'int'&gt;</msg>
<status status="PASS" starttime="20220722 15:42:45.002" endtime="20220722 15:42:45.003"/>
</kw>
<kw name="Set Test Variable" library="BuiltIn">
<arg>${actual}</arg>
<arg>${response.text}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<msg timestamp="20220722 15:42:45.004" level="INFO">${actual} = {"Message":"An error has occurred.","ExceptionMessage":"Token invalid","ExceptionType":"System.Exception","StackTrace":"   at SEMS.API.AuthorizationFilterAttribute.OnActionExecuting(HttpActionContext ...</msg>
<status status="PASS" starttime="20220722 15:42:45.003" endtime="20220722 15:42:45.004"/>
</kw>
<kw name="Run Keyword And Return Status" library="BuiltIn">
<var>${status}</var>
<arg>Should Be Equal As Strings</arg>
<arg>${statusCode}</arg>
<arg>${response.status_code}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<kw name="Should Be Equal As Strings" library="BuiltIn">
<arg>${statusCode}</arg>
<arg>${response.status_code}</arg>
<doc>Fails if objects are unequal after converting them to strings.</doc>
<msg timestamp="20220722 15:42:45.004" level="INFO">Argument types are:
&lt;class 'str'&gt;
&lt;class 'int'&gt;</msg>
<status status="PASS" starttime="20220722 15:42:45.004" endtime="20220722 15:42:45.004"/>
</kw>
<msg timestamp="20220722 15:42:45.005" level="INFO">${status} = True</msg>
<status status="PASS" starttime="20220722 15:42:45.004" endtime="20220722 15:42:45.005"/>
</kw>
<kw name="Write_Result_Status_To_Excel_HealthCheck" library="ExcelKeyword">
<arg>${EXCEL_NAME}</arg>
<arg>${SHEET_NAME}</arg>
<arg>${rowNo}</arg>
<arg>${status}</arg>
<kw name="Open Excel Document" library="ExcelLibraryV2">
<arg>${fileExcel}</arg>
<arg>Test</arg>
<doc>Opens xlsx document file.</doc>
<status status="PASS" starttime="20220722 15:42:45.005" endtime="20220722 15:42:45.027"/>
</kw>
<kw name="Log" library="BuiltIn">
<arg>${status}</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20220722 15:42:45.028" level="INFO">True</msg>
<status status="PASS" starttime="20220722 15:42:45.028" endtime="20220722 15:42:45.028"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>${status}==True</arg>
<arg>Write Excel Cell</arg>
<arg>row_num=${rowNo}</arg>
<arg>col_num=1</arg>
<arg>value=PASSED</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="Write Excel Cell" library="ExcelLibraryV2">
<arg>row_num=${rowNo}</arg>
<arg>col_num=1</arg>
<arg>value=PASSED</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Writes value to the cell.</doc>
<status status="PASS" starttime="20220722 15:42:45.028" endtime="20220722 15:42:45.028"/>
</kw>
<status status="PASS" starttime="20220722 15:42:45.028" endtime="20220722 15:42:45.028"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>${status}==False</arg>
<arg>Write Excel Cell</arg>
<arg>row_num=${rowNo}</arg>
<arg>col_num=1</arg>
<arg>value=FAILED</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" starttime="20220722 15:42:45.029" endtime="20220722 15:42:45.029"/>
</kw>
<kw name="Write Excel Cell" library="ExcelLibraryV2">
<arg>row_num=${rowNo}</arg>
<arg>col_num=4</arg>
<arg>value=${actual}</arg>
<arg>sheet_name=${sheetName}</arg>
<doc>Writes value to the cell.</doc>
<status status="PASS" starttime="20220722 15:42:45.029" endtime="20220722 15:42:45.029"/>
</kw>
<kw name="Save Excel Document" library="ExcelLibraryV2">
<arg>${fileExcel}</arg>
<doc>Saves the current document to disk.</doc>
<status status="PASS" starttime="20220722 15:42:45.029" endtime="20220722 15:42:45.089"/>
</kw>
<kw name="Close All Excel Documents" library="ExcelLibraryV2">
<doc>Closes all opened documents.</doc>
<status status="PASS" starttime="20220722 15:42:45.090" endtime="20220722 15:42:45.090"/>
</kw>
<kw name="Close All Excel Documents" library="ExcelLibraryV2" type="TEARDOWN">
<doc>Closes all opened documents.</doc>
<status status="PASS" starttime="20220722 15:42:45.090" endtime="20220722 15:42:45.090"/>
</kw>
<status status="PASS" starttime="20220722 15:42:45.005" endtime="20220722 15:42:45.090"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>${status}==False</arg>
<arg>Log</arg>
<arg>Fail</arg>
<arg>ELSE IF</arg>
<arg>${status}==True</arg>
<arg>Log</arg>
<arg>${actual}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="Log" library="BuiltIn">
<arg>${actual}</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20220722 15:42:45.091" level="INFO">{"Message":"An error has occurred.","ExceptionMessage":"Token invalid","ExceptionType":"System.Exception","StackTrace":"   at SEMS.API.AuthorizationFilterAttribute.OnActionExecuting(HttpActionContext actionContext)\r\n   at System.Web.Http.Filters.ActionFilterAttribute.OnActionExecutingAsync(HttpActionContext actionContext, CancellationToken cancellationToken)\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Web.Http.Filters.ActionFilterAttribute.&lt;ExecuteActionFilterAsyncCore&gt;d__5.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Web.Http.Controllers.ActionFilterResult.&lt;ExecuteAsync&gt;d__5.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Web.Http.Dispatcher.HttpControllerDispatcher.&lt;SendAsync&gt;d__15.MoveNext()"}</msg>
<status status="PASS" starttime="20220722 15:42:45.091" endtime="20220722 15:42:45.091"/>
</kw>
<status status="PASS" starttime="20220722 15:42:45.090" endtime="20220722 15:42:45.091"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.821" endtime="20220722 15:42:45.091"/>
</kw>
<msg timestamp="20220722 15:42:45.091" level="INFO">${data} = None</msg>
<status status="PASS" starttime="20220722 15:42:44.820" endtime="20220722 15:42:45.091"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.757" endtime="20220722 15:42:45.091"/>
</kw>
<kw name="Close Browser" library="Selenium2Library" type="TEARDOWN">
<doc>Closes the current browser.</doc>
<status status="PASS" starttime="20220722 15:42:45.092" endtime="20220722 15:42:45.092"/>
</kw>
<status status="PASS" starttime="20220722 15:42:44.755" endtime="20220722 15:42:45.092"/>
</test>
<status status="PASS" starttime="20220722 15:42:42.723" endtime="20220722 15:42:45.094"/>
</suite>
<statistics>
<total>
<stat pass="5" fail="0" skip="0">All Tests</stat>
</total>
<tag>
</tag>
<suite>
<stat pass="5" fail="0" skip="0" id="s1" name="HealthCheckReadiness">HealthCheckReadiness</stat>
</suite>
</statistics>
<errors>
</errors>
</robot>
